// @bun
var v4=Object.create;var{getPrototypeOf:b4,defineProperty:t1,getOwnPropertyNames:c4}=Object;var O4=Object.prototype.hasOwnProperty;var g4=($,P,H)=>{H=$!=null?v4(b4($)):{};let q=P||!$||!$.__esModule?t1(H,"default",{value:$,enumerable:!0}):H;for(let W of c4($))if(!O4.call(q,W))t1(q,W,{get:()=>$[W],enumerable:!0});return q};var w=($,P)=>()=>(P||$((P={exports:{}}).exports,P),P.exports);var f=import.meta.require;var u=w((lW,G2)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var j2=($)=>typeof $<"u"&&$!==null,WP=($)=>typeof $==="object",RP=($)=>Object.prototype.toString.call($)==="[object Object]",JP=($)=>typeof $==="function",UP=($)=>typeof $==="boolean",KP=($)=>$ instanceof Buffer,EP=($)=>{if(j2($))switch($.constructor){case Uint8Array:case Uint8ClampedArray:case Int8Array:case Uint16Array:case Int16Array:case Uint32Array:case Int32Array:case Float32Array:case Float64Array:return!0}return!1},NP=($)=>$ instanceof ArrayBuffer,QP=($)=>typeof $==="string"&&$.length>0,IP=($)=>typeof $==="number"&&!Number.isNaN($),ZP=($)=>Number.isInteger($),YP=($,P,H)=>$>=P&&$<=H,jP=($,P)=>P.includes($),GP=($,P,H)=>Error(`Expected ${P} for ${$} but received ${H} of type ${typeof H}`),AP=($,P)=>{return P.message=$.message,P};G2.exports={defined:j2,object:WP,plainObject:RP,fn:JP,bool:UP,buffer:KP,typedArray:EP,arrayBuffer:NP,string:QP,number:IP,integer:ZP,inRange:YP,inArray:jP,invalidParameterError:GP,nativeError:AP}});var B2=w((mW,X2)=>{var A2=()=>process.platform==="linux",e0=null,XP=()=>{if(!e0)if(A2()&&process.report){let $=process.report.excludeNetwork;process.report.excludeNetwork=!0,e0=process.report.getReport(),process.report.excludeNetwork=$}else e0={};return e0};X2.exports={isLinux:A2,getReport:XP}});var V2=w((rW,w2)=>{var Y0=f("fs"),BP=($)=>{let P=Y0.openSync($,"r"),H=Buffer.alloc(2048),q=Y0.readSync(P,H,0,2048,0);return Y0.close(P,()=>{}),H.subarray(0,q)},wP=($)=>new Promise((P,H)=>{Y0.open($,"r",(q,W)=>{if(q)H(q);else{let R=Buffer.alloc(2048);Y0.read(W,R,0,2048,0,(J,K)=>{P(R.subarray(0,K)),Y0.close(W,()=>{})})}})});w2.exports={LDD_PATH:"/usr/bin/ldd",SELF_PATH:"/proc/self/exe",readFileSync:BP,readFile:wP}});var z2=w((aW,L2)=>{var VP=($)=>{if($.length<64)return null;if($.readUInt32BE(0)!==2135247942)return null;if($.readUInt8(4)!==2)return null;if($.readUInt8(5)!==1)return null;let P=$.readUInt32LE(32),H=$.readUInt16LE(54),q=$.readUInt16LE(56);for(let W=0;W<q;W++){let R=P+W*H;if($.readUInt32LE(R)===3){let K=$.readUInt32LE(R+8),E=$.readUInt32LE(R+32);return $.subarray(K,K+E).toString().replace(/\0.*$/g,"")}}return null};L2.exports={interpreterPath:VP}});var s0=w((eW,O2)=>{var f2=f("child_process"),{isLinux:j0,getReport:T2}=B2(),{LDD_PATH:n0,SELF_PATH:F2,readFile:z1,readFileSync:D1}=V2(),{interpreterPath:C2}=z2(),l,m,r,P0="",y2=()=>{if(!P0)return new Promise(($)=>{f2.exec("getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",(P,H)=>{P0=P?" ":H,$(P0)})});return P0},x2=()=>{if(!P0)try{P0=f2.execSync("getconf GNU_LIBC_VERSION 2>&1 || true; ldd --version 2>&1 || true",{encoding:"utf8"})}catch($){P0=" "}return P0},t="glibc",S2=/LIBC[a-z0-9 \-).]*?(\d+\.\d+)/i,U0="musl",LP=($)=>$.includes("libc.musl-")||$.includes("ld-musl-"),_2=()=>{let $=T2();if($.header&&$.header.glibcVersionRuntime)return t;if(Array.isArray($.sharedObjects)){if($.sharedObjects.some(LP))return U0}return null},M2=($)=>{let[P,H]=$.split(/[\r\n]+/);if(P&&P.includes(t))return t;if(H&&H.includes(U0))return U0;return null},k2=($)=>{if($){if($.includes("/ld-musl-"))return U0;else if($.includes("/ld-linux-"))return t}return null},h2=($)=>{if($=$.toString(),$.includes("musl"))return U0;if($.includes("GNU C Library"))return t;return null},zP=async()=>{if(m!==void 0)return m;m=null;try{let $=await z1(n0);m=h2($)}catch($){}return m},DP=()=>{if(m!==void 0)return m;m=null;try{let $=D1(n0);m=h2($)}catch($){}return m},fP=async()=>{if(l!==void 0)return l;l=null;try{let $=await z1(F2),P=C2($);l=k2(P)}catch($){}return l},TP=()=>{if(l!==void 0)return l;l=null;try{let $=D1(F2),P=C2($);l=k2(P)}catch($){}return l},d2=async()=>{let $=null;if(j0()){if($=await fP(),!$){if($=await zP(),!$)$=_2();if(!$){let P=await y2();$=M2(P)}}}return $},v2=()=>{let $=null;if(j0()){if($=TP(),!$){if($=DP(),!$)$=_2();if(!$){let P=x2();$=M2(P)}}}return $},FP=async()=>j0()&&await d2()!==t,CP=()=>j0()&&v2()!==t,yP=async()=>{if(r!==void 0)return r;r=null;try{let P=(await z1(n0)).match(S2);if(P)r=P[1]}catch($){}return r},xP=()=>{if(r!==void 0)return r;r=null;try{let P=D1(n0).match(S2);if(P)r=P[1]}catch($){}return r},b2=()=>{let $=T2();if($.header&&$.header.glibcVersionRuntime)return $.header.glibcVersionRuntime;return null},D2=($)=>$.trim().split(/\s+/)[1],c2=($)=>{let[P,H,q]=$.split(/[\r\n]+/);if(P&&P.includes(t))return D2(P);if(H&&q&&H.includes(U0))return D2(q);return null},SP=async()=>{let $=null;if(j0()){if($=await yP(),!$)$=b2();if(!$){let P=await y2();$=c2(P)}}return $},_P=()=>{let $=null;if(j0()){if($=xP(),!$)$=b2();if(!$){let P=x2();$=c2(P)}}return $};O2.exports={GLIBC:t,MUSL:U0,family:d2,familySync:v2,isNonGlibcLinux:FP,isNonGlibcLinuxSync:CP,version:SP,versionSync:_P}});var S0=w((nW,g2)=>{var MP=typeof process==="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...$)=>console.error("SEMVER",...$):()=>{};g2.exports=MP});var t0=w((sW,u2)=>{var kP=Number.MAX_SAFE_INTEGER||9007199254740991,hP=["major","premajor","minor","preminor","patch","prepatch","prerelease"];u2.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:kP,RELEASE_TYPES:hP,SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var _0=w((a,l2)=>{var{MAX_SAFE_COMPONENT_LENGTH:f1,MAX_SAFE_BUILD_LENGTH:dP,MAX_LENGTH:vP}=t0(),bP=S0();a=l2.exports={};var cP=a.re=[],OP=a.safeRe=[],j=a.src=[],gP=a.safeSrc=[],G=a.t={},uP=0,T1="[a-zA-Z0-9-]",lP=[["\\s",1],["\\d",vP],[T1,dP]],mP=($)=>{for(let[P,H]of lP)$=$.split(`${P}*`).join(`${P}{0,${H}}`).split(`${P}+`).join(`${P}{1,${H}}`);return $},B=($,P,H)=>{let q=mP(P),W=uP++;bP($,W,P),G[$]=W,j[W]=P,gP[W]=q,cP[W]=new RegExp(P,H?"g":void 0),OP[W]=new RegExp(q,H?"g":void 0)};B("NUMERICIDENTIFIER","0|[1-9]\\d*");B("NUMERICIDENTIFIERLOOSE","\\d+");B("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${T1}*`);B("MAINVERSION",`(${j[G.NUMERICIDENTIFIER]})\\.(${j[G.NUMERICIDENTIFIER]})\\.(${j[G.NUMERICIDENTIFIER]})`);B("MAINVERSIONLOOSE",`(${j[G.NUMERICIDENTIFIERLOOSE]})\\.(${j[G.NUMERICIDENTIFIERLOOSE]})\\.(${j[G.NUMERICIDENTIFIERLOOSE]})`);B("PRERELEASEIDENTIFIER",`(?:${j[G.NONNUMERICIDENTIFIER]}|${j[G.NUMERICIDENTIFIER]})`);B("PRERELEASEIDENTIFIERLOOSE",`(?:${j[G.NONNUMERICIDENTIFIER]}|${j[G.NUMERICIDENTIFIERLOOSE]})`);B("PRERELEASE",`(?:-(${j[G.PRERELEASEIDENTIFIER]}(?:\\.${j[G.PRERELEASEIDENTIFIER]})*))`);B("PRERELEASELOOSE",`(?:-?(${j[G.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${j[G.PRERELEASEIDENTIFIERLOOSE]})*))`);B("BUILDIDENTIFIER",`${T1}+`);B("BUILD",`(?:\\+(${j[G.BUILDIDENTIFIER]}(?:\\.${j[G.BUILDIDENTIFIER]})*))`);B("FULLPLAIN",`v?${j[G.MAINVERSION]}${j[G.PRERELEASE]}?${j[G.BUILD]}?`);B("FULL",`^${j[G.FULLPLAIN]}$`);B("LOOSEPLAIN",`[v=\\s]*${j[G.MAINVERSIONLOOSE]}${j[G.PRERELEASELOOSE]}?${j[G.BUILD]}?`);B("LOOSE",`^${j[G.LOOSEPLAIN]}$`);B("GTLT","((?:<|>)?=?)");B("XRANGEIDENTIFIERLOOSE",`${j[G.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);B("XRANGEIDENTIFIER",`${j[G.NUMERICIDENTIFIER]}|x|X|\\*`);B("XRANGEPLAIN",`[v=\\s]*(${j[G.XRANGEIDENTIFIER]})(?:\\.(${j[G.XRANGEIDENTIFIER]})(?:\\.(${j[G.XRANGEIDENTIFIER]})(?:${j[G.PRERELEASE]})?${j[G.BUILD]}?)?)?`);B("XRANGEPLAINLOOSE",`[v=\\s]*(${j[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${j[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${j[G.XRANGEIDENTIFIERLOOSE]})(?:${j[G.PRERELEASELOOSE]})?${j[G.BUILD]}?)?)?`);B("XRANGE",`^${j[G.GTLT]}\\s*${j[G.XRANGEPLAIN]}$`);B("XRANGELOOSE",`^${j[G.GTLT]}\\s*${j[G.XRANGEPLAINLOOSE]}$`);B("COERCEPLAIN",`(^|[^\\d])(\\d{1,${f1}})(?:\\.(\\d{1,${f1}}))?(?:\\.(\\d{1,${f1}}))?`);B("COERCE",`${j[G.COERCEPLAIN]}(?:$|[^\\d])`);B("COERCEFULL",j[G.COERCEPLAIN]+`(?:${j[G.PRERELEASE]})?(?:${j[G.BUILD]})?(?:$|[^\\d])`);B("COERCERTL",j[G.COERCE],!0);B("COERCERTLFULL",j[G.COERCEFULL],!0);B("LONETILDE","(?:~>?)");B("TILDETRIM",`(\\s*)${j[G.LONETILDE]}\\s+`,!0);a.tildeTrimReplace="$1~";B("TILDE",`^${j[G.LONETILDE]}${j[G.XRANGEPLAIN]}$`);B("TILDELOOSE",`^${j[G.LONETILDE]}${j[G.XRANGEPLAINLOOSE]}$`);B("LONECARET","(?:\\^)");B("CARETTRIM",`(\\s*)${j[G.LONECARET]}\\s+`,!0);a.caretTrimReplace="$1^";B("CARET",`^${j[G.LONECARET]}${j[G.XRANGEPLAIN]}$`);B("CARETLOOSE",`^${j[G.LONECARET]}${j[G.XRANGEPLAINLOOSE]}$`);B("COMPARATORLOOSE",`^${j[G.GTLT]}\\s*(${j[G.LOOSEPLAIN]})$|^$`);B("COMPARATOR",`^${j[G.GTLT]}\\s*(${j[G.FULLPLAIN]})$|^$`);B("COMPARATORTRIM",`(\\s*)${j[G.GTLT]}\\s*(${j[G.LOOSEPLAIN]}|${j[G.XRANGEPLAIN]})`,!0);a.comparatorTrimReplace="$1$2$3";B("HYPHENRANGE",`^\\s*(${j[G.XRANGEPLAIN]})\\s+-\\s+(${j[G.XRANGEPLAIN]})\\s*$`);B("HYPHENRANGELOOSE",`^\\s*(${j[G.XRANGEPLAINLOOSE]})\\s+-\\s+(${j[G.XRANGEPLAINLOOSE]})\\s*$`);B("STAR","(<|>)?=?\\s*\\*");B("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");B("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var p0=w((tW,m2)=>{var rP=Object.freeze({loose:!0}),aP=Object.freeze({}),eP=($)=>{if(!$)return aP;if(typeof $!=="object")return rP;return $};m2.exports=eP});var n2=w((pW,e2)=>{var r2=/^[0-9]+$/,a2=($,P)=>{if(typeof $==="number"&&typeof P==="number")return $===P?0:$<P?-1:1;let H=r2.test($),q=r2.test(P);if(H&&q)$=+$,P=+P;return $===P?0:H&&!q?-1:q&&!H?1:$<P?-1:1},nP=($,P)=>a2(P,$);e2.exports={compareIdentifiers:a2,rcompareIdentifiers:nP}});var G0=w((iW,t2)=>{var i0=S0(),{MAX_LENGTH:s2,MAX_SAFE_INTEGER:o0}=t0(),{safeRe:$1,t:P1}=_0(),sP=p0(),{compareIdentifiers:F1}=n2();class O{constructor($,P){if(P=sP(P),$ instanceof O)if($.loose===!!P.loose&&$.includePrerelease===!!P.includePrerelease)return $;else $=$.version;else if(typeof $!=="string")throw TypeError(`Invalid version. Must be a string. Got type "${typeof $}".`);if($.length>s2)throw TypeError(`version is longer than ${s2} characters`);i0("SemVer",$,P),this.options=P,this.loose=!!P.loose,this.includePrerelease=!!P.includePrerelease;let H=$.trim().match(P.loose?$1[P1.LOOSE]:$1[P1.FULL]);if(!H)throw TypeError(`Invalid Version: ${$}`);if(this.raw=$,this.major=+H[1],this.minor=+H[2],this.patch=+H[3],this.major>o0||this.major<0)throw TypeError("Invalid major version");if(this.minor>o0||this.minor<0)throw TypeError("Invalid minor version");if(this.patch>o0||this.patch<0)throw TypeError("Invalid patch version");if(!H[4])this.prerelease=[];else this.prerelease=H[4].split(".").map((q)=>{if(/^[0-9]+$/.test(q)){let W=+q;if(W>=0&&W<o0)return W}return q});this.build=H[5]?H[5].split("."):[],this.format()}format(){if(this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length)this.version+=`-${this.prerelease.join(".")}`;return this.version}toString(){return this.version}compare($){if(i0("SemVer.compare",this.version,this.options,$),!($ instanceof O)){if(typeof $==="string"&&$===this.version)return 0;$=new O($,this.options)}if($.version===this.version)return 0;return this.compareMain($)||this.comparePre($)}compareMain($){if(!($ instanceof O))$=new O($,this.options);if(this.major<$.major)return-1;if(this.major>$.major)return 1;if(this.minor<$.minor)return-1;if(this.minor>$.minor)return 1;if(this.patch<$.patch)return-1;if(this.patch>$.patch)return 1;return 0}comparePre($){if(!($ instanceof O))$=new O($,this.options);if(this.prerelease.length&&!$.prerelease.length)return-1;else if(!this.prerelease.length&&$.prerelease.length)return 1;else if(!this.prerelease.length&&!$.prerelease.length)return 0;let P=0;do{let H=this.prerelease[P],q=$.prerelease[P];if(i0("prerelease compare",P,H,q),H===void 0&&q===void 0)return 0;else if(q===void 0)return 1;else if(H===void 0)return-1;else if(H===q)continue;else return F1(H,q)}while(++P)}compareBuild($){if(!($ instanceof O))$=new O($,this.options);let P=0;do{let H=this.build[P],q=$.build[P];if(i0("build compare",P,H,q),H===void 0&&q===void 0)return 0;else if(q===void 0)return 1;else if(H===void 0)return-1;else if(H===q)continue;else return F1(H,q)}while(++P)}inc($,P,H){if($.startsWith("pre")){if(!P&&H===!1)throw Error("invalid increment argument: identifier is empty");if(P){let q=`-${P}`.match(this.options.loose?$1[P1.PRERELEASELOOSE]:$1[P1.PRERELEASE]);if(!q||q[1]!==P)throw Error(`invalid identifier: ${P}`)}}switch($){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",P,H);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",P,H);break;case"prepatch":this.prerelease.length=0,this.inc("patch",P,H),this.inc("pre",P,H);break;case"prerelease":if(this.prerelease.length===0)this.inc("patch",P,H);this.inc("pre",P,H);break;case"release":if(this.prerelease.length===0)throw Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":if(this.minor!==0||this.patch!==0||this.prerelease.length===0)this.major++;this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":if(this.patch!==0||this.prerelease.length===0)this.minor++;this.patch=0,this.prerelease=[];break;case"patch":if(this.prerelease.length===0)this.patch++;this.prerelease=[];break;case"pre":{let q=Number(H)?1:0;if(this.prerelease.length===0)this.prerelease=[q];else{let W=this.prerelease.length;while(--W>=0)if(typeof this.prerelease[W]==="number")this.prerelease[W]++,W=-2;if(W===-1){if(P===this.prerelease.join(".")&&H===!1)throw Error("invalid increment argument: identifier already exists");this.prerelease.push(q)}}if(P){let W=[P,q];if(H===!1)W=[P];if(F1(this.prerelease[0],P)===0){if(isNaN(this.prerelease[1]))this.prerelease=W}else this.prerelease=W}break}default:throw Error(`invalid increment argument: ${$}`)}if(this.raw=this.format(),this.build.length)this.raw+=`+${this.build.join(".")}`;return this}}t2.exports=O});var o2=w((oW,i2)=>{var p2=G0(),tP=($,P,H=!1)=>{if($ instanceof p2)return $;try{return new p2($,P)}catch(q){if(!H)return null;throw q}};i2.exports=tP});var P$=w(($R,$$)=>{var pP=G0(),iP=o2(),{safeRe:H1,t:q1}=_0(),oP=($,P)=>{if($ instanceof pP)return $;if(typeof $==="number")$=String($);if(typeof $!=="string")return null;P=P||{};let H=null;if(!P.rtl)H=$.match(P.includePrerelease?H1[q1.COERCEFULL]:H1[q1.COERCE]);else{let E=P.includePrerelease?H1[q1.COERCERTLFULL]:H1[q1.COERCERTL],I;while((I=E.exec($))&&(!H||H.index+H[0].length!==$.length)){if(!H||I.index+I[0].length!==H.index+H[0].length)H=I;E.lastIndex=I.index+I[1].length+I[2].length}E.lastIndex=-1}if(H===null)return null;let q=H[2],W=H[3]||"0",R=H[4]||"0",J=P.includePrerelease&&H[5]?`-${H[5]}`:"",K=P.includePrerelease&&H[6]?`+${H[6]}`:"";return iP(`${q}.${W}.${R}${J}${K}`,P)};$$.exports=oP});var K0=w((PR,q$)=>{var H$=G0(),$6=($,P,H)=>new H$($,H).compare(new H$(P,H));q$.exports=$6});var C1=w((HR,W$)=>{var P6=K0(),H6=($,P,H)=>P6($,P,H)>=0;W$.exports=H6});var U$=w((qR,J$)=>{class R${constructor(){this.max=1000,this.map=new Map}get($){let P=this.map.get($);if(P===void 0)return;else return this.map.delete($),this.map.set($,P),P}delete($){return this.map.delete($)}set($,P){if(!this.delete($)&&P!==void 0){if(this.map.size>=this.max){let q=this.map.keys().next().value;this.delete(q)}this.map.set($,P)}return this}}J$.exports=R$});var E$=w((WR,K$)=>{var q6=K0(),W6=($,P,H)=>q6($,P,H)===0;K$.exports=W6});var Q$=w((RR,N$)=>{var R6=K0(),J6=($,P,H)=>R6($,P,H)!==0;N$.exports=J6});var Z$=w((JR,I$)=>{var U6=K0(),K6=($,P,H)=>U6($,P,H)>0;I$.exports=K6});var j$=w((UR,Y$)=>{var E6=K0(),N6=($,P,H)=>E6($,P,H)<0;Y$.exports=N6});var A$=w((KR,G$)=>{var Q6=K0(),I6=($,P,H)=>Q6($,P,H)<=0;G$.exports=I6});var B$=w((ER,X$)=>{var Z6=E$(),Y6=Q$(),j6=Z$(),G6=C1(),A6=j$(),X6=A$(),B6=($,P,H,q)=>{switch(P){case"===":if(typeof $==="object")$=$.version;if(typeof H==="object")H=H.version;return $===H;case"!==":if(typeof $==="object")$=$.version;if(typeof H==="object")H=H.version;return $!==H;case"":case"=":case"==":return Z6($,H,q);case"!=":return Y6($,H,q);case">":return j6($,H,q);case">=":return G6($,H,q);case"<":return A6($,H,q);case"<=":return X6($,H,q);default:throw TypeError(`Invalid operator: ${P}`)}};X$.exports=B6});var T$=w((NR,f$)=>{var M0=Symbol("SemVer ANY");class W1{static get ANY(){return M0}constructor($,P){if(P=w$(P),$ instanceof W1)if($.loose===!!P.loose)return $;else $=$.value;if($=$.trim().split(/\s+/).join(" "),x1("comparator",$,P),this.options=P,this.loose=!!P.loose,this.parse($),this.semver===M0)this.value="";else this.value=this.operator+this.semver.version;x1("comp",this)}parse($){let P=this.options.loose?V$[L$.COMPARATORLOOSE]:V$[L$.COMPARATOR],H=$.match(P);if(!H)throw TypeError(`Invalid comparator: ${$}`);if(this.operator=H[1]!==void 0?H[1]:"",this.operator==="=")this.operator="";if(!H[2])this.semver=M0;else this.semver=new z$(H[2],this.options.loose)}toString(){return this.value}test($){if(x1("Comparator.test",$,this.options.loose),this.semver===M0||$===M0)return!0;if(typeof $==="string")try{$=new z$($,this.options)}catch(P){return!1}return y1($,this.operator,this.semver,this.options)}intersects($,P){if(!($ instanceof W1))throw TypeError("a Comparator is required");if(this.operator===""){if(this.value==="")return!0;return new D$($.value,P).test(this.value)}else if($.operator===""){if($.value==="")return!0;return new D$(this.value,P).test($.semver)}if(P=w$(P),P.includePrerelease&&(this.value==="<0.0.0-0"||$.value==="<0.0.0-0"))return!1;if(!P.includePrerelease&&(this.value.startsWith("<0.0.0")||$.value.startsWith("<0.0.0")))return!1;if(this.operator.startsWith(">")&&$.operator.startsWith(">"))return!0;if(this.operator.startsWith("<")&&$.operator.startsWith("<"))return!0;if(this.semver.version===$.semver.version&&this.operator.includes("=")&&$.operator.includes("="))return!0;if(y1(this.semver,"<",$.semver,P)&&this.operator.startsWith(">")&&$.operator.startsWith("<"))return!0;if(y1(this.semver,">",$.semver,P)&&this.operator.startsWith("<")&&$.operator.startsWith(">"))return!0;return!1}}f$.exports=W1;var w$=p0(),{safeRe:V$,t:L$}=_0(),y1=B$(),x1=S0(),z$=G0(),D$=S1()});var S1=w((QR,x$)=>{var w6=/\s+/g;class k0{constructor($,P){if(P=L6(P),$ instanceof k0)if($.loose===!!P.loose&&$.includePrerelease===!!P.includePrerelease)return $;else return new k0($.raw,P);if($ instanceof _1)return this.raw=$.value,this.set=[[$]],this.formatted=void 0,this;if(this.options=P,this.loose=!!P.loose,this.includePrerelease=!!P.includePrerelease,this.raw=$.trim().replace(w6," "),this.set=this.raw.split("||").map((H)=>this.parseRange(H.trim())).filter((H)=>H.length),!this.set.length)throw TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let H=this.set[0];if(this.set=this.set.filter((q)=>!C$(q[0])),this.set.length===0)this.set=[H];else if(this.set.length>1){for(let q of this.set)if(q.length===1&&y6(q[0])){this.set=[q];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let $=0;$<this.set.length;$++){if($>0)this.formatted+="||";let P=this.set[$];for(let H=0;H<P.length;H++){if(H>0)this.formatted+=" ";this.formatted+=P[H].toString().trim()}}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange($){let H=((this.options.includePrerelease&&F6)|(this.options.loose&&C6))+":"+$,q=F$.get(H);if(q)return q;let W=this.options.loose,R=W?S[x.HYPHENRANGELOOSE]:S[x.HYPHENRANGE];$=$.replace(R,c6(this.options.includePrerelease)),D("hyphen replace",$),$=$.replace(S[x.COMPARATORTRIM],D6),D("comparator trim",$),$=$.replace(S[x.TILDETRIM],f6),D("tilde trim",$),$=$.replace(S[x.CARETTRIM],T6),D("caret trim",$);let J=$.split(" ").map((Z)=>x6(Z,this.options)).join(" ").split(/\s+/).map((Z)=>b6(Z,this.options));if(W)J=J.filter((Z)=>{return D("loose invalid filter",Z,this.options),!!Z.match(S[x.COMPARATORLOOSE])});D("range list",J);let K=new Map,E=J.map((Z)=>new _1(Z,this.options));for(let Z of E){if(C$(Z))return[Z];K.set(Z.value,Z)}if(K.size>1&&K.has(""))K.delete("");let I=[...K.values()];return F$.set(H,I),I}intersects($,P){if(!($ instanceof k0))throw TypeError("a Range is required");return this.set.some((H)=>{return y$(H,P)&&$.set.some((q)=>{return y$(q,P)&&H.every((W)=>{return q.every((R)=>{return W.intersects(R,P)})})})})}test($){if(!$)return!1;if(typeof $==="string")try{$=new z6($,this.options)}catch(P){return!1}for(let P=0;P<this.set.length;P++)if(O6(this.set[P],$,this.options))return!0;return!1}}x$.exports=k0;var V6=U$(),F$=new V6,L6=p0(),_1=T$(),D=S0(),z6=G0(),{safeRe:S,t:x,comparatorTrimReplace:D6,tildeTrimReplace:f6,caretTrimReplace:T6}=_0(),{FLAG_INCLUDE_PRERELEASE:F6,FLAG_LOOSE:C6}=t0(),C$=($)=>$.value==="<0.0.0-0",y6=($)=>$.value==="",y$=($,P)=>{let H=!0,q=$.slice(),W=q.pop();while(H&&q.length)H=q.every((R)=>{return W.intersects(R,P)}),W=q.pop();return H},x6=($,P)=>{return $=$.replace(S[x.BUILD],""),D("comp",$,P),$=M6($,P),D("caret",$),$=S6($,P),D("tildes",$),$=h6($,P),D("xrange",$),$=v6($,P),D("stars",$),$},_=($)=>!$||$.toLowerCase()==="x"||$==="*",S6=($,P)=>{return $.trim().split(/\s+/).map((H)=>_6(H,P)).join(" ")},_6=($,P)=>{let H=P.loose?S[x.TILDELOOSE]:S[x.TILDE];return $.replace(H,(q,W,R,J,K)=>{D("tilde",$,q,W,R,J,K);let E;if(_(W))E="";else if(_(R))E=`>=${W}.0.0 <${+W+1}.0.0-0`;else if(_(J))E=`>=${W}.${R}.0 <${W}.${+R+1}.0-0`;else if(K)D("replaceTilde pr",K),E=`>=${W}.${R}.${J}-${K} <${W}.${+R+1}.0-0`;else E=`>=${W}.${R}.${J} <${W}.${+R+1}.0-0`;return D("tilde return",E),E})},M6=($,P)=>{return $.trim().split(/\s+/).map((H)=>k6(H,P)).join(" ")},k6=($,P)=>{D("caret",$,P);let H=P.loose?S[x.CARETLOOSE]:S[x.CARET],q=P.includePrerelease?"-0":"";return $.replace(H,(W,R,J,K,E)=>{D("caret",$,W,R,J,K,E);let I;if(_(R))I="";else if(_(J))I=`>=${R}.0.0${q} <${+R+1}.0.0-0`;else if(_(K))if(R==="0")I=`>=${R}.${J}.0${q} <${R}.${+J+1}.0-0`;else I=`>=${R}.${J}.0${q} <${+R+1}.0.0-0`;else if(E)if(D("replaceCaret pr",E),R==="0")if(J==="0")I=`>=${R}.${J}.${K}-${E} <${R}.${J}.${+K+1}-0`;else I=`>=${R}.${J}.${K}-${E} <${R}.${+J+1}.0-0`;else I=`>=${R}.${J}.${K}-${E} <${+R+1}.0.0-0`;else if(D("no pr"),R==="0")if(J==="0")I=`>=${R}.${J}.${K}${q} <${R}.${J}.${+K+1}-0`;else I=`>=${R}.${J}.${K}${q} <${R}.${+J+1}.0-0`;else I=`>=${R}.${J}.${K} <${+R+1}.0.0-0`;return D("caret return",I),I})},h6=($,P)=>{return D("replaceXRanges",$,P),$.split(/\s+/).map((H)=>d6(H,P)).join(" ")},d6=($,P)=>{$=$.trim();let H=P.loose?S[x.XRANGELOOSE]:S[x.XRANGE];return $.replace(H,(q,W,R,J,K,E)=>{D("xRange",$,q,W,R,J,K,E);let I=_(R),Z=I||_(J),X=Z||_(K),z=X;if(W==="="&&z)W="";if(E=P.includePrerelease?"-0":"",I)if(W===">"||W==="<")q="<0.0.0-0";else q="*";else if(W&&z){if(Z)J=0;if(K=0,W===">")if(W=">=",Z)R=+R+1,J=0,K=0;else J=+J+1,K=0;else if(W==="<=")if(W="<",Z)R=+R+1;else J=+J+1;if(W==="<")E="-0";q=`${W+R}.${J}.${K}${E}`}else if(Z)q=`>=${R}.0.0${E} <${+R+1}.0.0-0`;else if(X)q=`>=${R}.${J}.0${E} <${R}.${+J+1}.0-0`;return D("xRange return",q),q})},v6=($,P)=>{return D("replaceStars",$,P),$.trim().replace(S[x.STAR],"")},b6=($,P)=>{return D("replaceGTE0",$,P),$.trim().replace(S[P.includePrerelease?x.GTE0PRE:x.GTE0],"")},c6=($)=>(P,H,q,W,R,J,K,E,I,Z,X,z)=>{if(_(q))H="";else if(_(W))H=`>=${q}.0.0${$?"-0":""}`;else if(_(R))H=`>=${q}.${W}.0${$?"-0":""}`;else if(J)H=`>=${H}`;else H=`>=${H}${$?"-0":""}`;if(_(I))E="";else if(_(Z))E=`<${+I+1}.0.0-0`;else if(_(X))E=`<${I}.${+Z+1}.0-0`;else if(z)E=`<=${I}.${Z}.${X}-${z}`;else if($)E=`<${I}.${Z}.${+X+1}-0`;else E=`<=${E}`;return`${H} ${E}`.trim()},O6=($,P,H)=>{for(let q=0;q<$.length;q++)if(!$[q].test(P))return!1;if(P.prerelease.length&&!H.includePrerelease){for(let q=0;q<$.length;q++){if(D($[q].semver),$[q].semver===_1.ANY)continue;if($[q].semver.prerelease.length>0){let W=$[q].semver;if(W.major===P.major&&W.minor===P.minor&&W.patch===P.patch)return!0}}return!1}return!0}});var _$=w((IR,S$)=>{var g6=S1(),u6=($,P,H)=>{try{P=new g6(P,H)}catch(q){return!1}return P.test($)};S$.exports=u6});var M1=w((ZR,l6)=>{l6.exports={name:"sharp",description:"High performance Node.js image processing, the fastest module to resize JPEG, PNG, WebP, GIF, AVIF and TIFF images",version:"0.34.5",author:"Lovell Fuller <npm@lovell.info>",homepage:"https://sharp.pixelplumbing.com",contributors:["Pierre Inglebert <pierre.inglebert@gmail.com>","Jonathan Ong <jonathanrichardong@gmail.com>","Chanon Sajjamanochai <chanon.s@gmail.com>","Juliano Julio <julianojulio@gmail.com>","Daniel Gasienica <daniel@gasienica.ch>","Julian Walker <julian@fiftythree.com>","Amit Pitaru <pitaru.amit@gmail.com>","Brandon Aaron <hello.brandon@aaron.sh>","Andreas Lind <andreas@one.com>","Maurus Cuelenaere <mcuelenaere@gmail.com>","Linus Unneb\xE4ck <linus@folkdatorn.se>","Victor Mateevitsi <mvictoras@gmail.com>","Alaric Holloway <alaric.holloway@gmail.com>","Bernhard K. Weisshuhn <bkw@codingforce.com>","Chris Riley <criley@primedia.com>","David Carley <dacarley@gmail.com>","John Tobin <john@limelightmobileinc.com>","Kenton Gray <kentongray@gmail.com>","Felix B\xFCnemann <Felix.Buenemann@gmail.com>","Samy Al Zahrani <samyalzahrany@gmail.com>","Chintan Thakkar <lemnisk8@gmail.com>","F. Orlando Galashan <frulo@gmx.de>","Kleis Auke Wolthuizen <info@kleisauke.nl>","Matt Hirsch <mhirsch@media.mit.edu>","Matthias Thoemmes <thoemmes@gmail.com>","Patrick Paskaris <patrick@paskaris.gr>","J\xE9r\xE9my Lal <kapouer@melix.org>","Rahul Nanwani <r.nanwani@gmail.com>","Alice Monday <alice0meta@gmail.com>","Kristo Jorgenson <kristo.jorgenson@gmail.com>","YvesBos <yves_bos@outlook.com>","Guy Maliar <guy@tailorbrands.com>","Nicolas Coden <nicolas@ncoden.fr>","Matt Parrish <matt.r.parrish@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Matthew McEachen <matthew+github@mceachen.org>","Jarda Kot\u011B\u0161ovec <jarda.kotesovec@gmail.com>","Kenric D'Souza <kenric.dsouza@gmail.com>","Oleh Aleinyk <oleg.aleynik@gmail.com>","Marcel Bretschneider <marcel.bretschneider@gmail.com>","Andrea Bianco <andrea.bianco@unibas.ch>","Rik Heywood <rik@rik.org>","Thomas Parisot <hi@oncletom.io>","Nathan Graves <nathanrgraves+github@gmail.com>","Tom Lokhorst <tom@lokhorst.eu>","Espen Hovlandsdal <espen@hovlandsdal.com>","Sylvain Dumont <sylvain.dumont35@gmail.com>","Alun Davies <alun.owain.davies@googlemail.com>","Aidan Hoolachan <ajhoolachan21@gmail.com>","Axel Eirola <axel.eirola@iki.fi>","Freezy <freezy@xbmc.org>","Daiz <taneli.vatanen@gmail.com>","Julian Aubourg <j@ubourg.net>","Keith Belovay <keith@picthrive.com>","Michael B. Klein <mbklein@gmail.com>","Jordan Prudhomme <jordan@raboland.fr>","Ilya Ovdin <iovdin@gmail.com>","Andargor <andargor@yahoo.com>","Paul Neave <paul.neave@gmail.com>","Brendan Kennedy <brenwken@gmail.com>","Brychan Bennett-Odlum <git@brychan.io>","Edward Silverton <e.silverton@gmail.com>","Roman Malieiev <aromaleev@gmail.com>","Tomas Szabo <tomas.szabo@deftomat.com>","Robert O'Rourke <robert@o-rourke.org>","Guillermo Alfonso Varela Chouci\xF1o <guillevch@gmail.com>","Christian Flintrup <chr@gigahost.dk>","Manan Jadhav <manan@motionden.com>","Leon Radley <leon@radley.se>","alza54 <alza54@thiocod.in>","Jacob Smith <jacob@frende.me>","Michael Nutt <michael@nutt.im>","Brad Parham <baparham@gmail.com>","Taneli Vatanen <taneli.vatanen@gmail.com>","Joris Dugu\xE9 <zaruike10@gmail.com>","Chris Banks <christopher.bradley.banks@gmail.com>","Ompal Singh <ompal.hitm09@gmail.com>","Brodan <christopher.hranj@gmail.com>","Ankur Parihar <ankur.github@gmail.com>","Brahim Ait elhaj <brahima@gmail.com>","Mart Jansink <m.jansink@gmail.com>","Lachlan Newman <lachnewman007@gmail.com>","Dennis Beatty <dennis@dcbeatty.com>","Ingvar Stepanyan <me@rreverser.com>","Don Denton <don@happycollision.com>"],scripts:{build:"node install/build.js",install:"node install/check.js || npm run build",clean:"rm -rf src/build/ .nyc_output/ coverage/ test/fixtures/output.*",test:"npm run lint && npm run test-unit",lint:"npm run lint-cpp && npm run lint-js && npm run lint-types","lint-cpp":"cpplint --quiet src/*.h src/*.cc","lint-js":"biome lint","lint-types":"tsd --files ./test/types/sharp.test-d.ts","test-leak":"./test/leak/leak.sh","test-unit":"node --experimental-test-coverage test/unit.mjs","package-from-local-build":"node npm/from-local-build.js","package-release-notes":"node npm/release-notes.js","docs-build":"node docs/build.mjs","docs-serve":"cd docs && npm start","docs-publish":"cd docs && npm run build && npx firebase-tools deploy --project pixelplumbing --only hosting:pixelplumbing-sharp"},type:"commonjs",main:"lib/index.js",types:"lib/index.d.ts",files:["install","lib","src/*.{cc,h,gyp}"],repository:{type:"git",url:"git://github.com/lovell/sharp.git"},keywords:["jpeg","png","webp","avif","tiff","gif","svg","jp2","dzi","image","resize","thumbnail","crop","embed","libvips","vips"],dependencies:{"@img/colour":"^1.0.0","detect-libc":"^2.1.2",semver:"^7.7.3"},optionalDependencies:{"@img/sharp-darwin-arm64":"0.34.5","@img/sharp-darwin-x64":"0.34.5","@img/sharp-libvips-darwin-arm64":"1.2.4","@img/sharp-libvips-darwin-x64":"1.2.4","@img/sharp-libvips-linux-arm":"1.2.4","@img/sharp-libvips-linux-arm64":"1.2.4","@img/sharp-libvips-linux-ppc64":"1.2.4","@img/sharp-libvips-linux-riscv64":"1.2.4","@img/sharp-libvips-linux-s390x":"1.2.4","@img/sharp-libvips-linux-x64":"1.2.4","@img/sharp-libvips-linuxmusl-arm64":"1.2.4","@img/sharp-libvips-linuxmusl-x64":"1.2.4","@img/sharp-linux-arm":"0.34.5","@img/sharp-linux-arm64":"0.34.5","@img/sharp-linux-ppc64":"0.34.5","@img/sharp-linux-riscv64":"0.34.5","@img/sharp-linux-s390x":"0.34.5","@img/sharp-linux-x64":"0.34.5","@img/sharp-linuxmusl-arm64":"0.34.5","@img/sharp-linuxmusl-x64":"0.34.5","@img/sharp-wasm32":"0.34.5","@img/sharp-win32-arm64":"0.34.5","@img/sharp-win32-ia32":"0.34.5","@img/sharp-win32-x64":"0.34.5"},devDependencies:{"@biomejs/biome":"^2.3.4","@cpplint/cli":"^0.1.0","@emnapi/runtime":"^1.7.0","@img/sharp-libvips-dev":"1.2.4","@img/sharp-libvips-dev-wasm32":"1.2.4","@img/sharp-libvips-win32-arm64":"1.2.4","@img/sharp-libvips-win32-ia32":"1.2.4","@img/sharp-libvips-win32-x64":"1.2.4","@types/node":"*",emnapi:"^1.7.0","exif-reader":"^2.0.2","extract-zip":"^2.0.1",icc:"^3.0.0","jsdoc-to-markdown":"^9.1.3","node-addon-api":"^8.5.0","node-gyp":"^11.5.0","tar-fs":"^3.1.1",tsd:"^0.33.0"},license:"Apache-2.0",engines:{node:"^18.17.0 || ^20.3.0 || >=21.0.0"},config:{libvips:">=8.17.3"},funding:{url:"https://opencollective.com/libvips"}}});var h1=w((YR,u$)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var{spawnSync:R1}=f("child_process"),{createHash:m6}=f("crypto"),d$=P$(),r6=C1(),a6=_$(),M$=s0(),{config:e6,engines:k$,optionalDependencies:n6}=M1(),s6=process.env.npm_package_config_libvips||e6.libvips,v$=d$(s6).version,t6=["darwin-arm64","darwin-x64","linux-arm","linux-arm64","linux-ppc64","linux-riscv64","linux-s390x","linux-x64","linuxmusl-arm64","linuxmusl-x64","win32-arm64","win32-ia32","win32-x64"],J1={encoding:"utf8",shell:!0},p6=($)=>{if($ instanceof Error)console.error(`sharp: Installation error: ${$.message}`);else console.log(`sharp: ${$}`)},b$=()=>M$.isNonGlibcLinuxSync()?M$.familySync():"",i6=()=>`${process.platform}${b$()}-${process.arch}`,A0=()=>{if(c$())return"wasm32";let{npm_config_arch:$,npm_config_platform:P,npm_config_libc:H}=process.env,q=typeof H==="string"?H:b$();return`${P||process.platform}${q}-${$||process.arch}`},o6=()=>{try{return f(`@img/sharp-libvips-dev-${A0()}/include`)}catch{try{return (()=>{throw new Error("Cannot require module "+"@img/sharp-libvips-dev/include");})()}catch{}}return""},$5=()=>{try{return (()=>{throw new Error("Cannot require module "+"@img/sharp-libvips-dev/cplusplus");})()}catch{}return""},P5=()=>{try{return f(`@img/sharp-libvips-dev-${A0()}/lib`)}catch{try{return f(`@img/sharp-libvips-${A0()}/lib`)}catch{}}return""},H5=()=>{if(process.release?.name==="node"&&process.versions){if(!a6(process.versions.node,k$.node))return{found:process.versions.node,expected:k$.node}}},c$=()=>{let{CC:$}=process.env;return Boolean($?.endsWith("/emcc"))},q5=()=>{if(process.platform==="darwin"&&process.arch==="x64")return(R1("sysctl sysctl.proc_translated",J1).stdout||"").trim()==="sysctl.proc_translated: 1";return!1},h$=($)=>m6("sha512").update($).digest("hex"),W5=()=>{try{let $=h$(`imgsharp-libvips-${A0()}`),P=d$(n6[`@img/sharp-libvips-${A0()}`],{includePrerelease:!0}).version;return h$(`${$}npm:${P}`).slice(0,10)}catch{}return""},R5=()=>R1(`node-gyp rebuild --directory=src ${c$()?"--nodedir=emscripten":""}`,{...J1,stdio:"inherit"}).status,O$=()=>{if(process.platform!=="win32")return(R1("pkg-config --modversion vips-cpp",{...J1,env:{...process.env,PKG_CONFIG_PATH:g$()}}).stdout||"").trim();else return""},g$=()=>{if(process.platform!=="win32")return[(R1('which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d" " -f2',J1).stdout||"").trim(),process.env.PKG_CONFIG_PATH,"/usr/local/lib/pkgconfig","/usr/lib/pkgconfig","/usr/local/libdata/pkgconfig","/usr/libdata/pkgconfig"].filter(Boolean).join(":");else return""},k1=($,P,H)=>{if(H)H(`Detected ${P}, skipping search for globally-installed libvips`);return $},J5=($)=>{if(Boolean(process.env.SHARP_IGNORE_GLOBAL_LIBVIPS)===!0)return k1(!1,"SHARP_IGNORE_GLOBAL_LIBVIPS",$);if(Boolean(process.env.SHARP_FORCE_GLOBAL_LIBVIPS)===!0)return k1(!0,"SHARP_FORCE_GLOBAL_LIBVIPS",$);if(q5())return k1(!1,"Rosetta",$);let P=O$();return!!P&&r6(P,v$)};u$.exports={minimumLibvipsVersion:v$,prebuiltPlatforms:t6,buildPlatformArch:A0,buildSharpLibvipsIncludeDir:o6,buildSharpLibvipsCPlusPlusDir:$5,buildSharpLibvipsLibDir:P5,isUnsupportedNodeRuntime:H5,runtimePlatformArch:i6,log:p6,yarnLocator:W5,spawnRebuild:R5,globalLibvipsVersion:O$,pkgConfigPath:g$,useGlobalLibvips:J5}});var d0=w((GR,m$)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var{familySync:U5,versionSync:K5}=s0(),{runtimePlatformArch:E5,isUnsupportedNodeRuntime:l$,prebuiltPlatforms:N5,minimumLibvipsVersion:Q5}=h1(),E0=E5(),I5=[`../src/build/Release/sharp-${E0}.node`,"../src/build/Release/sharp-wasm32.node",`@img/sharp-${E0}/sharp.node`,"@img/sharp-wasm32/sharp.node"],d1,X0,h0=[];for(d1 of I5)try{X0=f(d1);break}catch($){h0.push($)}if(X0&&d1.startsWith("@img/sharp-linux-x64")&&!X0._isUsingX64V2()){let $=Error("Prebuilt binaries for linux-x64 require v2 microarchitecture");$.code="Unsupported CPU",h0.push($),X0=null}if(X0)m$.exports=X0;else{let[$,P,H]=["linux","darwin","win32"].map((R)=>E0.startsWith(R)),q=[`Could not load the "sharp" module using the ${E0} runtime`];h0.forEach((R)=>{if(R.code!=="MODULE_NOT_FOUND")q.push(`${R.code}: ${R.message}`)});let W=h0.map((R)=>R.message).join(" ");if(q.push("Possible solutions:"),l$()){let{found:R,expected:J}=l$();q.push("- Please upgrade Node.js:",`    Found ${R}`,`    Requires ${J}`)}else if(N5.includes(E0)){let[R,J]=E0.split("-"),K=R.endsWith("musl")?" --libc=musl":"";q.push("- Ensure optional dependencies can be installed:","    npm install --include=optional sharp","- Ensure your package manager supports multi-platform installation:","    See https://sharp.pixelplumbing.com/install#cross-platform","- Add platform-specific dependencies:",`    npm install --os=${R.replace("musl","")}${K} --cpu=${J} sharp`)}else q.push(`- Manually install libvips >= ${Q5}`,"- Add experimental WebAssembly-based dependencies:","    npm install --cpu=wasm32 sharp","    npm install @img/sharp-wasm32");if($&&/(symbol not found|CXXABI_)/i.test(W))try{let{config:R}=f(`@img/sharp-libvips-${E0}/package`),J=`${U5()} ${K5()}`,K=`${R.musl?"musl":"glibc"} ${R.musl||R.glibc}`;q.push("- Update your OS:",`    Found ${J}`,`    Requires ${K}`)}catch(R){}if($&&/\/snap\/core[0-9]{2}/.test(W))q.push("- Remove the Node.js Snap, which does not support native modules","    snap remove node");if(P&&/Incompatible library version/.test(W))q.push("- Update Homebrew:","    brew update && brew upgrade vips");if(h0.some((R)=>R.code==="ERR_DLOPEN_DISABLED"))q.push("- Run Node.js without using the --no-addons flag");if(H&&/The specified procedure could not be found/.test(W))q.push("- Using the canvas package on Windows?","    See https://sharp.pixelplumbing.com/install#canvas-and-windows","- Check for outdated versions of sharp in the dependency tree:","    npm ls sharp");throw q.push("- Consult the installation documentation:","    See https://sharp.pixelplumbing.com/install"),Error(q.join(`
`))}});var a$=w((XR,r$)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var Z5=f("util"),v1=f("stream"),Y5=u();d0();var j5=Z5.debuglog("sharp"),G5=($)=>{N0.queue.emit("change",$)},N0=function($,P){if(arguments.length===1&&!Y5.defined($))throw Error("Invalid input");if(!(this instanceof N0))return new N0($,P);return v1.Duplex.call(this),this.options={topOffsetPre:-1,leftOffsetPre:-1,widthPre:-1,heightPre:-1,topOffsetPost:-1,leftOffsetPost:-1,widthPost:-1,heightPost:-1,width:-1,height:-1,canvas:"crop",position:0,resizeBackground:[0,0,0,255],angle:0,rotationAngle:0,rotationBackground:[0,0,0,255],rotateBefore:!1,orientBefore:!1,flip:!1,flop:!1,extendTop:0,extendBottom:0,extendLeft:0,extendRight:0,extendBackground:[0,0,0,255],extendWith:"background",withoutEnlargement:!1,withoutReduction:!1,affineMatrix:[],affineBackground:[0,0,0,255],affineIdx:0,affineIdy:0,affineOdx:0,affineOdy:0,affineInterpolator:this.constructor.interpolators.bilinear,kernel:"lanczos3",fastShrinkOnLoad:!0,tint:[-1,0,0,0],flatten:!1,flattenBackground:[0,0,0],unflatten:!1,negate:!1,negateAlpha:!0,medianSize:0,blurSigma:0,precision:"integer",minAmpl:0.2,sharpenSigma:0,sharpenM1:1,sharpenM2:2,sharpenX1:2,sharpenY2:10,sharpenY3:20,threshold:0,thresholdGrayscale:!0,trimBackground:[],trimThreshold:-1,trimLineArt:!1,dilateWidth:0,erodeWidth:0,gamma:0,gammaOut:0,greyscale:!1,normalise:!1,normaliseLower:1,normaliseUpper:99,claheWidth:0,claheHeight:0,claheMaxSlope:3,brightness:1,saturation:1,hue:0,lightness:0,booleanBufferIn:null,booleanFileIn:"",joinChannelIn:[],extractChannel:-1,removeAlpha:!1,ensureAlpha:-1,colourspace:"srgb",colourspacePipeline:"last",composite:[],fileOut:"",formatOut:"input",streamOut:!1,keepMetadata:0,withMetadataOrientation:-1,withMetadataDensity:0,withIccProfile:"",withExif:{},withExifMerge:!0,withXmp:"",resolveWithObject:!1,loop:-1,delay:[],jpegQuality:80,jpegProgressive:!1,jpegChromaSubsampling:"4:2:0",jpegTrellisQuantisation:!1,jpegOvershootDeringing:!1,jpegOptimiseScans:!1,jpegOptimiseCoding:!0,jpegQuantisationTable:0,pngProgressive:!1,pngCompressionLevel:6,pngAdaptiveFiltering:!1,pngPalette:!1,pngQuality:100,pngEffort:7,pngBitdepth:8,pngDither:1,jp2Quality:80,jp2TileHeight:512,jp2TileWidth:512,jp2Lossless:!1,jp2ChromaSubsampling:"4:4:4",webpQuality:80,webpAlphaQuality:100,webpLossless:!1,webpNearLossless:!1,webpSmartSubsample:!1,webpSmartDeblock:!1,webpPreset:"default",webpEffort:4,webpMinSize:!1,webpMixed:!1,gifBitdepth:8,gifEffort:7,gifDither:1,gifInterFrameMaxError:0,gifInterPaletteMaxError:3,gifKeepDuplicateFrames:!1,gifReuse:!0,gifProgressive:!1,tiffQuality:80,tiffCompression:"jpeg",tiffBigtiff:!1,tiffPredictor:"horizontal",tiffPyramid:!1,tiffMiniswhite:!1,tiffBitdepth:8,tiffTile:!1,tiffTileHeight:256,tiffTileWidth:256,tiffXres:1,tiffYres:1,tiffResolutionUnit:"inch",heifQuality:50,heifLossless:!1,heifCompression:"av1",heifEffort:4,heifChromaSubsampling:"4:4:4",heifBitdepth:8,jxlDistance:1,jxlDecodingTier:0,jxlEffort:7,jxlLossless:!1,rawDepth:"uchar",tileSize:256,tileOverlap:0,tileContainer:"fs",tileLayout:"dz",tileFormat:"last",tileDepth:"last",tileAngle:0,tileSkipBlanks:-1,tileBackground:[255,255,255,255],tileCentre:!1,tileId:"https://example.com/iiif",tileBasename:"",timeoutSeconds:0,linearA:[],linearB:[],pdfBackground:[255,255,255,255],debuglog:(H)=>{this.emit("warning",H),j5(H)},queueListener:G5},this.options.input=this._createInputDescriptor($,P,{allowStream:!0}),this};Object.setPrototypeOf(N0.prototype,v1.Duplex.prototype);Object.setPrototypeOf(N0,v1.Duplex);function A5(){let $=this.constructor.call(),{debuglog:P,queueListener:H,...q}=this.options;if($.options=structuredClone(q),$.options.debuglog=P,$.options.queueListener=H,this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),$.options.input.buffer=this.options.input.buffer,$.emit("finish")});return $}Object.assign(N0.prototype,{clone:A5});r$.exports=N0});var s$=w((BR,n$)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var N=u(),H0=d0(),X5={left:"low",top:"low",low:"low",center:"centre",centre:"centre",right:"high",bottom:"high",high:"high"},B5=["failOn","limitInputPixels","unlimited","animated","autoOrient","density","ignoreIcc","page","pages","sequentialRead","jp2","openSlide","pdf","raw","svg","tiff","failOnError","openSlideLevel","pdfBackground","tiffSubifd"];function e$($){let P=B5.filter((H)=>N.defined($[H])).map((H)=>[H,$[H]]);return P.length?Object.fromEntries(P):void 0}function w5($,P,H){let q={autoOrient:!1,failOn:"warning",limitInputPixels:268402689,ignoreIcc:!1,unlimited:!1,sequentialRead:!0};if(N.string($))q.file=$;else if(N.buffer($)){if($.length===0)throw Error("Input Buffer is empty");q.buffer=$}else if(N.arrayBuffer($)){if($.byteLength===0)throw Error("Input bit Array is empty");q.buffer=Buffer.from($,0,$.byteLength)}else if(N.typedArray($)){if($.length===0)throw Error("Input Bit Array is empty");q.buffer=Buffer.from($.buffer,$.byteOffset,$.byteLength)}else if(N.plainObject($)&&!N.defined(P)){if(P=$,e$(P))q.buffer=[]}else if(!N.defined($)&&!N.defined(P)&&N.object(H)&&H.allowStream)q.buffer=[];else if(Array.isArray($))if($.length>1)if(!this.options.joining)this.options.joining=!0,this.options.join=$.map((W)=>this._createInputDescriptor(W));else throw Error("Recursive join is unsupported");else throw Error("Expected at least two images to join");else throw Error(`Unsupported input '${$}' of type ${typeof $}${N.defined(P)?` when also providing options of type ${typeof P}`:""}`);if(N.object(P)){if(N.defined(P.failOnError))if(N.bool(P.failOnError))q.failOn=P.failOnError?"warning":"none";else throw N.invalidParameterError("failOnError","boolean",P.failOnError);if(N.defined(P.failOn))if(N.string(P.failOn)&&N.inArray(P.failOn,["none","truncated","error","warning"]))q.failOn=P.failOn;else throw N.invalidParameterError("failOn","one of: none, truncated, error, warning",P.failOn);if(N.defined(P.autoOrient))if(N.bool(P.autoOrient))q.autoOrient=P.autoOrient;else throw N.invalidParameterError("autoOrient","boolean",P.autoOrient);if(N.defined(P.density))if(N.inRange(P.density,1,1e5))q.density=P.density;else throw N.invalidParameterError("density","number between 1 and 100000",P.density);if(N.defined(P.ignoreIcc))if(N.bool(P.ignoreIcc))q.ignoreIcc=P.ignoreIcc;else throw N.invalidParameterError("ignoreIcc","boolean",P.ignoreIcc);if(N.defined(P.limitInputPixels))if(N.bool(P.limitInputPixels))q.limitInputPixels=P.limitInputPixels?268402689:0;else if(N.integer(P.limitInputPixels)&&N.inRange(P.limitInputPixels,0,Number.MAX_SAFE_INTEGER))q.limitInputPixels=P.limitInputPixels;else throw N.invalidParameterError("limitInputPixels","positive integer",P.limitInputPixels);if(N.defined(P.unlimited))if(N.bool(P.unlimited))q.unlimited=P.unlimited;else throw N.invalidParameterError("unlimited","boolean",P.unlimited);if(N.defined(P.sequentialRead))if(N.bool(P.sequentialRead))q.sequentialRead=P.sequentialRead;else throw N.invalidParameterError("sequentialRead","boolean",P.sequentialRead);if(N.defined(P.raw)){if(N.object(P.raw)&&N.integer(P.raw.width)&&P.raw.width>0&&N.integer(P.raw.height)&&P.raw.height>0&&N.integer(P.raw.channels)&&N.inRange(P.raw.channels,1,4))switch(q.rawWidth=P.raw.width,q.rawHeight=P.raw.height,q.rawChannels=P.raw.channels,$.constructor){case Uint8Array:case Uint8ClampedArray:q.rawDepth="uchar";break;case Int8Array:q.rawDepth="char";break;case Uint16Array:q.rawDepth="ushort";break;case Int16Array:q.rawDepth="short";break;case Uint32Array:q.rawDepth="uint";break;case Int32Array:q.rawDepth="int";break;case Float32Array:q.rawDepth="float";break;case Float64Array:q.rawDepth="double";break;default:q.rawDepth="uchar";break}else throw Error("Expected width, height and channels for raw pixel input");if(q.rawPremultiplied=!1,N.defined(P.raw.premultiplied))if(N.bool(P.raw.premultiplied))q.rawPremultiplied=P.raw.premultiplied;else throw N.invalidParameterError("raw.premultiplied","boolean",P.raw.premultiplied);if(q.rawPageHeight=0,N.defined(P.raw.pageHeight))if(N.integer(P.raw.pageHeight)&&P.raw.pageHeight>0&&P.raw.pageHeight<=P.raw.height){if(P.raw.height%P.raw.pageHeight!==0)throw Error(`Expected raw.height ${P.raw.height} to be a multiple of raw.pageHeight ${P.raw.pageHeight}`);q.rawPageHeight=P.raw.pageHeight}else throw N.invalidParameterError("raw.pageHeight","positive integer",P.raw.pageHeight)}if(N.defined(P.animated))if(N.bool(P.animated))q.pages=P.animated?-1:1;else throw N.invalidParameterError("animated","boolean",P.animated);if(N.defined(P.pages))if(N.integer(P.pages)&&N.inRange(P.pages,-1,1e5))q.pages=P.pages;else throw N.invalidParameterError("pages","integer between -1 and 100000",P.pages);if(N.defined(P.page))if(N.integer(P.page)&&N.inRange(P.page,0,1e5))q.page=P.page;else throw N.invalidParameterError("page","integer between 0 and 100000",P.page);if(N.object(P.openSlide)&&N.defined(P.openSlide.level))if(N.integer(P.openSlide.level)&&N.inRange(P.openSlide.level,0,256))q.openSlideLevel=P.openSlide.level;else throw N.invalidParameterError("openSlide.level","integer between 0 and 256",P.openSlide.level);else if(N.defined(P.level))if(N.integer(P.level)&&N.inRange(P.level,0,256))q.openSlideLevel=P.level;else throw N.invalidParameterError("level","integer between 0 and 256",P.level);if(N.object(P.tiff)&&N.defined(P.tiff.subifd))if(N.integer(P.tiff.subifd)&&N.inRange(P.tiff.subifd,-1,1e5))q.tiffSubifd=P.tiff.subifd;else throw N.invalidParameterError("tiff.subifd","integer between -1 and 100000",P.tiff.subifd);else if(N.defined(P.subifd))if(N.integer(P.subifd)&&N.inRange(P.subifd,-1,1e5))q.tiffSubifd=P.subifd;else throw N.invalidParameterError("subifd","integer between -1 and 100000",P.subifd);if(N.object(P.svg)){if(N.defined(P.svg.stylesheet))if(N.string(P.svg.stylesheet))q.svgStylesheet=P.svg.stylesheet;else throw N.invalidParameterError("svg.stylesheet","string",P.svg.stylesheet);if(N.defined(P.svg.highBitdepth))if(N.bool(P.svg.highBitdepth))q.svgHighBitdepth=P.svg.highBitdepth;else throw N.invalidParameterError("svg.highBitdepth","boolean",P.svg.highBitdepth)}if(N.object(P.pdf)&&N.defined(P.pdf.background))q.pdfBackground=this._getBackgroundColourOption(P.pdf.background);else if(N.defined(P.pdfBackground))q.pdfBackground=this._getBackgroundColourOption(P.pdfBackground);if(N.object(P.jp2)&&N.defined(P.jp2.oneshot))if(N.bool(P.jp2.oneshot))q.jp2Oneshot=P.jp2.oneshot;else throw N.invalidParameterError("jp2.oneshot","boolean",P.jp2.oneshot);if(N.defined(P.create))if(N.object(P.create)&&N.integer(P.create.width)&&P.create.width>0&&N.integer(P.create.height)&&P.create.height>0&&N.integer(P.create.channels)){if(q.createWidth=P.create.width,q.createHeight=P.create.height,q.createChannels=P.create.channels,q.createPageHeight=0,N.defined(P.create.pageHeight))if(N.integer(P.create.pageHeight)&&P.create.pageHeight>0&&P.create.pageHeight<=P.create.height){if(P.create.height%P.create.pageHeight!==0)throw Error(`Expected create.height ${P.create.height} to be a multiple of create.pageHeight ${P.create.pageHeight}`);q.createPageHeight=P.create.pageHeight}else throw N.invalidParameterError("create.pageHeight","positive integer",P.create.pageHeight);if(N.defined(P.create.noise)){if(!N.object(P.create.noise))throw Error("Expected noise to be an object");if(P.create.noise.type!=="gaussian")throw Error("Only gaussian noise is supported at the moment");if(q.createNoiseType=P.create.noise.type,!N.inRange(P.create.channels,1,4))throw N.invalidParameterError("create.channels","number between 1 and 4",P.create.channels);if(q.createNoiseMean=128,N.defined(P.create.noise.mean))if(N.number(P.create.noise.mean)&&N.inRange(P.create.noise.mean,0,1e4))q.createNoiseMean=P.create.noise.mean;else throw N.invalidParameterError("create.noise.mean","number between 0 and 10000",P.create.noise.mean);if(q.createNoiseSigma=30,N.defined(P.create.noise.sigma))if(N.number(P.create.noise.sigma)&&N.inRange(P.create.noise.sigma,0,1e4))q.createNoiseSigma=P.create.noise.sigma;else throw N.invalidParameterError("create.noise.sigma","number between 0 and 10000",P.create.noise.sigma)}else if(N.defined(P.create.background)){if(!N.inRange(P.create.channels,3,4))throw N.invalidParameterError("create.channels","number between 3 and 4",P.create.channels);q.createBackground=this._getBackgroundColourOption(P.create.background)}else throw Error("Expected valid noise or background to create a new input image");delete q.buffer}else throw Error("Expected valid width, height and channels to create a new input image");if(N.defined(P.text))if(N.object(P.text)&&N.string(P.text.text)){if(q.textValue=P.text.text,N.defined(P.text.height)&&N.defined(P.text.dpi))throw Error("Expected only one of dpi or height");if(N.defined(P.text.font))if(N.string(P.text.font))q.textFont=P.text.font;else throw N.invalidParameterError("text.font","string",P.text.font);if(N.defined(P.text.fontfile))if(N.string(P.text.fontfile))q.textFontfile=P.text.fontfile;else throw N.invalidParameterError("text.fontfile","string",P.text.fontfile);if(N.defined(P.text.width))if(N.integer(P.text.width)&&P.text.width>0)q.textWidth=P.text.width;else throw N.invalidParameterError("text.width","positive integer",P.text.width);if(N.defined(P.text.height))if(N.integer(P.text.height)&&P.text.height>0)q.textHeight=P.text.height;else throw N.invalidParameterError("text.height","positive integer",P.text.height);if(N.defined(P.text.align))if(N.string(P.text.align)&&N.string(this.constructor.align[P.text.align]))q.textAlign=this.constructor.align[P.text.align];else throw N.invalidParameterError("text.align","valid alignment",P.text.align);if(N.defined(P.text.justify))if(N.bool(P.text.justify))q.textJustify=P.text.justify;else throw N.invalidParameterError("text.justify","boolean",P.text.justify);if(N.defined(P.text.dpi))if(N.integer(P.text.dpi)&&N.inRange(P.text.dpi,1,1e6))q.textDpi=P.text.dpi;else throw N.invalidParameterError("text.dpi","integer between 1 and 1000000",P.text.dpi);if(N.defined(P.text.rgba))if(N.bool(P.text.rgba))q.textRgba=P.text.rgba;else throw N.invalidParameterError("text.rgba","bool",P.text.rgba);if(N.defined(P.text.spacing))if(N.integer(P.text.spacing)&&N.inRange(P.text.spacing,-1e6,1e6))q.textSpacing=P.text.spacing;else throw N.invalidParameterError("text.spacing","integer between -1000000 and 1000000",P.text.spacing);if(N.defined(P.text.wrap))if(N.string(P.text.wrap)&&N.inArray(P.text.wrap,["word","char","word-char","none"]))q.textWrap=P.text.wrap;else throw N.invalidParameterError("text.wrap","one of: word, char, word-char, none",P.text.wrap);delete q.buffer}else throw Error("Expected a valid string to create an image with text.");if(N.defined(P.join))if(N.defined(this.options.join)){if(N.defined(P.join.animated))if(N.bool(P.join.animated))q.joinAnimated=P.join.animated;else throw N.invalidParameterError("join.animated","boolean",P.join.animated);if(N.defined(P.join.across))if(N.integer(P.join.across)&&N.inRange(P.join.across,1,1e6))q.joinAcross=P.join.across;else throw N.invalidParameterError("join.across","integer between 1 and 100000",P.join.across);if(N.defined(P.join.shim))if(N.integer(P.join.shim)&&N.inRange(P.join.shim,0,1e6))q.joinShim=P.join.shim;else throw N.invalidParameterError("join.shim","integer between 0 and 100000",P.join.shim);if(N.defined(P.join.background))q.joinBackground=this._getBackgroundColourOption(P.join.background);if(N.defined(P.join.halign))if(N.string(P.join.halign)&&N.string(this.constructor.align[P.join.halign]))q.joinHalign=this.constructor.align[P.join.halign];else throw N.invalidParameterError("join.halign","valid alignment",P.join.halign);if(N.defined(P.join.valign))if(N.string(P.join.valign)&&N.string(this.constructor.align[P.join.valign]))q.joinValign=this.constructor.align[P.join.valign];else throw N.invalidParameterError("join.valign","valid alignment",P.join.valign)}else throw Error("Expected input to be an array of images to join")}else if(N.defined(P))throw Error(`Invalid input options ${P}`);return q}function V5($,P,H){if(Array.isArray(this.options.input.buffer))if(N.buffer($)){if(this.options.input.buffer.length===0)this.on("finish",()=>{this.streamInFinished=!0});this.options.input.buffer.push($),H()}else H(Error("Non-Buffer data on Writable Stream"));else H(Error("Unexpected data on Writable Stream"))}function L5(){if(this._isStreamInput())this.options.input.buffer=Buffer.concat(this.options.input.buffer)}function z5(){return Array.isArray(this.options.input.buffer)}function D5($){let P=Error();if(N.fn($)){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),H0.metadata(this.options,(H,q)=>{if(H)$(N.nativeError(H,P));else $(null,q)})});else H0.metadata(this.options,(H,q)=>{if(H)$(N.nativeError(H,P));else $(null,q)});return this}else if(this._isStreamInput())return new Promise((H,q)=>{let W=()=>{this._flattenBufferIn(),H0.metadata(this.options,(R,J)=>{if(R)q(N.nativeError(R,P));else H(J)})};if(this.writableFinished)W();else this.once("finish",W)});else return new Promise((H,q)=>{H0.metadata(this.options,(W,R)=>{if(W)q(N.nativeError(W,P));else H(R)})})}function f5($){let P=Error();if(N.fn($)){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),H0.stats(this.options,(H,q)=>{if(H)$(N.nativeError(H,P));else $(null,q)})});else H0.stats(this.options,(H,q)=>{if(H)$(N.nativeError(H,P));else $(null,q)});return this}else if(this._isStreamInput())return new Promise((H,q)=>{this.on("finish",function(){this._flattenBufferIn(),H0.stats(this.options,(W,R)=>{if(W)q(N.nativeError(W,P));else H(R)})})});else return new Promise((H,q)=>{H0.stats(this.options,(W,R)=>{if(W)q(N.nativeError(W,P));else H(R)})})}n$.exports=($)=>{Object.assign($.prototype,{_inputOptionsFromObject:e$,_createInputDescriptor:w5,_write:V5,_flattenBufferIn:L5,_isStreamInput:z5,metadata:D5,stats:f5}),$.align=X5}});var P4=w((wR,$4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var A=u(),p$={center:0,centre:0,north:1,east:2,south:3,west:4,northeast:5,southeast:6,southwest:7,northwest:8},i$={top:1,right:2,bottom:3,left:4,"right top":5,"right bottom":6,"left bottom":7,"left top":8},t$={background:"background",copy:"copy",repeat:"repeat",mirror:"mirror"},o$={entropy:16,attention:17},b1={nearest:"nearest",linear:"linear",cubic:"cubic",mitchell:"mitchell",lanczos2:"lanczos2",lanczos3:"lanczos3",mks2013:"mks2013",mks2021:"mks2021"},T5={contain:"contain",cover:"cover",fill:"fill",inside:"inside",outside:"outside"},F5={contain:"embed",cover:"crop",fill:"ignore_aspect",inside:"max",outside:"min"};function c1($){return $.angle%360!==0||$.rotationAngle!==0}function U1($){return $.width!==-1||$.height!==-1}function C5($,P,H){if(U1(this.options))this.options.debuglog("ignoring previous resize options");if(this.options.widthPost!==-1)this.options.debuglog("operation order will be: extract, resize, extract");if(A.defined($))if(A.object($)&&!A.defined(H))H=$;else if(A.integer($)&&$>0)this.options.width=$;else throw A.invalidParameterError("width","positive integer",$);else this.options.width=-1;if(A.defined(P))if(A.integer(P)&&P>0)this.options.height=P;else throw A.invalidParameterError("height","positive integer",P);else this.options.height=-1;if(A.object(H)){if(A.defined(H.width))if(A.integer(H.width)&&H.width>0)this.options.width=H.width;else throw A.invalidParameterError("width","positive integer",H.width);if(A.defined(H.height))if(A.integer(H.height)&&H.height>0)this.options.height=H.height;else throw A.invalidParameterError("height","positive integer",H.height);if(A.defined(H.fit)){let q=F5[H.fit];if(A.string(q))this.options.canvas=q;else throw A.invalidParameterError("fit","valid fit",H.fit)}if(A.defined(H.position)){let q=A.integer(H.position)?H.position:o$[H.position]||i$[H.position]||p$[H.position];if(A.integer(q)&&(A.inRange(q,0,8)||A.inRange(q,16,17)))this.options.position=q;else throw A.invalidParameterError("position","valid position/gravity/strategy",H.position)}if(this._setBackgroundColourOption("resizeBackground",H.background),A.defined(H.kernel))if(A.string(b1[H.kernel]))this.options.kernel=b1[H.kernel];else throw A.invalidParameterError("kernel","valid kernel name",H.kernel);if(A.defined(H.withoutEnlargement))this._setBooleanOption("withoutEnlargement",H.withoutEnlargement);if(A.defined(H.withoutReduction))this._setBooleanOption("withoutReduction",H.withoutReduction);if(A.defined(H.fastShrinkOnLoad))this._setBooleanOption("fastShrinkOnLoad",H.fastShrinkOnLoad)}if(c1(this.options)&&U1(this.options))this.options.rotateBefore=!0;return this}function y5($){if(A.integer($)&&$>0)this.options.extendTop=$,this.options.extendBottom=$,this.options.extendLeft=$,this.options.extendRight=$;else if(A.object($)){if(A.defined($.top))if(A.integer($.top)&&$.top>=0)this.options.extendTop=$.top;else throw A.invalidParameterError("top","positive integer",$.top);if(A.defined($.bottom))if(A.integer($.bottom)&&$.bottom>=0)this.options.extendBottom=$.bottom;else throw A.invalidParameterError("bottom","positive integer",$.bottom);if(A.defined($.left))if(A.integer($.left)&&$.left>=0)this.options.extendLeft=$.left;else throw A.invalidParameterError("left","positive integer",$.left);if(A.defined($.right))if(A.integer($.right)&&$.right>=0)this.options.extendRight=$.right;else throw A.invalidParameterError("right","positive integer",$.right);if(this._setBackgroundColourOption("extendBackground",$.background),A.defined($.extendWith))if(A.string(t$[$.extendWith]))this.options.extendWith=t$[$.extendWith];else throw A.invalidParameterError("extendWith","one of: background, copy, repeat, mirror",$.extendWith)}else throw A.invalidParameterError("extend","integer or object",$);return this}function x5($){let P=U1(this.options)||this.options.widthPre!==-1?"Post":"Pre";if(this.options[`width${P}`]!==-1)this.options.debuglog("ignoring previous extract options");if(["left","top","width","height"].forEach(function(H){let q=$[H];if(A.integer(q)&&q>=0)this.options[H+(H==="left"||H==="top"?"Offset":"")+P]=q;else throw A.invalidParameterError(H,"integer",q)},this),c1(this.options)&&!U1(this.options)){if(this.options.widthPre===-1||this.options.widthPost===-1)this.options.rotateBefore=!0}if(this.options.input.autoOrient)this.options.orientBefore=!0;return this}function S5($){if(this.options.trimThreshold=10,A.defined($))if(A.object($)){if(A.defined($.background))this._setBackgroundColourOption("trimBackground",$.background);if(A.defined($.threshold))if(A.number($.threshold)&&$.threshold>=0)this.options.trimThreshold=$.threshold;else throw A.invalidParameterError("threshold","positive number",$.threshold);if(A.defined($.lineArt))this._setBooleanOption("trimLineArt",$.lineArt)}else throw A.invalidParameterError("trim","object",$);if(c1(this.options))this.options.rotateBefore=!0;return this}$4.exports=($)=>{Object.assign($.prototype,{resize:C5,extend:y5,extract:x5,trim:S5}),$.gravity=p$,$.strategy=o$,$.kernel=b1,$.fit=T5,$.position=i$}});var q4=w((VR,H4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var V=u(),O1={clear:"clear",source:"source",over:"over",in:"in",out:"out",atop:"atop",dest:"dest","dest-over":"dest-over","dest-in":"dest-in","dest-out":"dest-out","dest-atop":"dest-atop",xor:"xor",add:"add",saturate:"saturate",multiply:"multiply",screen:"screen",overlay:"overlay",darken:"darken",lighten:"lighten","colour-dodge":"colour-dodge","color-dodge":"colour-dodge","colour-burn":"colour-burn","color-burn":"colour-burn","hard-light":"hard-light","soft-light":"soft-light",difference:"difference",exclusion:"exclusion"};function _5($){if(!Array.isArray($))throw V.invalidParameterError("images to composite","array",$);return this.options.composite=$.map((P)=>{if(!V.object(P))throw V.invalidParameterError("image to composite","object",P);let H=this._inputOptionsFromObject(P),q={input:this._createInputDescriptor(P.input,H,{allowStream:!1}),blend:"over",tile:!1,left:0,top:0,hasOffset:!1,gravity:0,premultiplied:!1};if(V.defined(P.blend))if(V.string(O1[P.blend]))q.blend=O1[P.blend];else throw V.invalidParameterError("blend","valid blend name",P.blend);if(V.defined(P.tile))if(V.bool(P.tile))q.tile=P.tile;else throw V.invalidParameterError("tile","boolean",P.tile);if(V.defined(P.left))if(V.integer(P.left))q.left=P.left;else throw V.invalidParameterError("left","integer",P.left);if(V.defined(P.top))if(V.integer(P.top))q.top=P.top;else throw V.invalidParameterError("top","integer",P.top);if(V.defined(P.top)!==V.defined(P.left))throw Error("Expected both left and top to be set");else q.hasOffset=V.integer(P.top)&&V.integer(P.left);if(V.defined(P.gravity))if(V.integer(P.gravity)&&V.inRange(P.gravity,0,8))q.gravity=P.gravity;else if(V.string(P.gravity)&&V.integer(this.constructor.gravity[P.gravity]))q.gravity=this.constructor.gravity[P.gravity];else throw V.invalidParameterError("gravity","valid gravity",P.gravity);if(V.defined(P.premultiplied))if(V.bool(P.premultiplied))q.premultiplied=P.premultiplied;else throw V.invalidParameterError("premultiplied","boolean",P.premultiplied);return q}),this}H4.exports=($)=>{$.prototype.composite=_5,$.blend=O1}});var K4=w((LR,U4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var Q=u(),W4={integer:"integer",float:"float",approximate:"approximate"};function M5($,P){if(!Q.defined($))return this.autoOrient();if(this.options.angle||this.options.rotationAngle)this.options.debuglog("ignoring previous rotate options"),this.options.angle=0,this.options.rotationAngle=0;if(Q.integer($)&&!($%90))this.options.angle=$;else if(Q.number($)){if(this.options.rotationAngle=$,Q.object(P)&&P.background)this._setBackgroundColourOption("rotationBackground",P.background)}else throw Q.invalidParameterError("angle","numeric",$);return this}function k5(){return this.options.input.autoOrient=!0,this}function h5($){return this.options.flip=Q.bool($)?$:!0,this}function d5($){return this.options.flop=Q.bool($)?$:!0,this}function v5($,P){let H=[].concat(...$);if(H.length===4&&H.every(Q.number))this.options.affineMatrix=H;else throw Q.invalidParameterError("matrix","1x4 or 2x2 array",$);if(Q.defined(P))if(Q.object(P)){if(this._setBackgroundColourOption("affineBackground",P.background),Q.defined(P.idx))if(Q.number(P.idx))this.options.affineIdx=P.idx;else throw Q.invalidParameterError("options.idx","number",P.idx);if(Q.defined(P.idy))if(Q.number(P.idy))this.options.affineIdy=P.idy;else throw Q.invalidParameterError("options.idy","number",P.idy);if(Q.defined(P.odx))if(Q.number(P.odx))this.options.affineOdx=P.odx;else throw Q.invalidParameterError("options.odx","number",P.odx);if(Q.defined(P.ody))if(Q.number(P.ody))this.options.affineOdy=P.ody;else throw Q.invalidParameterError("options.ody","number",P.ody);if(Q.defined(P.interpolator))if(Q.inArray(P.interpolator,Object.values(this.constructor.interpolators)))this.options.affineInterpolator=P.interpolator;else throw Q.invalidParameterError("options.interpolator","valid interpolator name",P.interpolator)}else throw Q.invalidParameterError("options","object",P);return this}function b5($,P,H){if(!Q.defined($))this.options.sharpenSigma=-1;else if(Q.bool($))this.options.sharpenSigma=$?-1:0;else if(Q.number($)&&Q.inRange($,0.01,1e4)){if(this.options.sharpenSigma=$,Q.defined(P))if(Q.number(P)&&Q.inRange(P,0,1e4))this.options.sharpenM1=P;else throw Q.invalidParameterError("flat","number between 0 and 10000",P);if(Q.defined(H))if(Q.number(H)&&Q.inRange(H,0,1e4))this.options.sharpenM2=H;else throw Q.invalidParameterError("jagged","number between 0 and 10000",H)}else if(Q.plainObject($)){if(Q.number($.sigma)&&Q.inRange($.sigma,0.000001,10))this.options.sharpenSigma=$.sigma;else throw Q.invalidParameterError("options.sigma","number between 0.000001 and 10",$.sigma);if(Q.defined($.m1))if(Q.number($.m1)&&Q.inRange($.m1,0,1e6))this.options.sharpenM1=$.m1;else throw Q.invalidParameterError("options.m1","number between 0 and 1000000",$.m1);if(Q.defined($.m2))if(Q.number($.m2)&&Q.inRange($.m2,0,1e6))this.options.sharpenM2=$.m2;else throw Q.invalidParameterError("options.m2","number between 0 and 1000000",$.m2);if(Q.defined($.x1))if(Q.number($.x1)&&Q.inRange($.x1,0,1e6))this.options.sharpenX1=$.x1;else throw Q.invalidParameterError("options.x1","number between 0 and 1000000",$.x1);if(Q.defined($.y2))if(Q.number($.y2)&&Q.inRange($.y2,0,1e6))this.options.sharpenY2=$.y2;else throw Q.invalidParameterError("options.y2","number between 0 and 1000000",$.y2);if(Q.defined($.y3))if(Q.number($.y3)&&Q.inRange($.y3,0,1e6))this.options.sharpenY3=$.y3;else throw Q.invalidParameterError("options.y3","number between 0 and 1000000",$.y3)}else throw Q.invalidParameterError("sigma","number between 0.01 and 10000",$);return this}function c5($){if(!Q.defined($))this.options.medianSize=3;else if(Q.integer($)&&Q.inRange($,1,1000))this.options.medianSize=$;else throw Q.invalidParameterError("size","integer between 1 and 1000",$);return this}function O5($){let P;if(Q.number($))P=$;else if(Q.plainObject($)){if(!Q.number($.sigma))throw Q.invalidParameterError("options.sigma","number between 0.3 and 1000",P);if(P=$.sigma,"precision"in $)if(Q.string(W4[$.precision]))this.options.precision=W4[$.precision];else throw Q.invalidParameterError("precision","one of: integer, float, approximate",$.precision);if("minAmplitude"in $)if(Q.number($.minAmplitude)&&Q.inRange($.minAmplitude,0.001,1))this.options.minAmpl=$.minAmplitude;else throw Q.invalidParameterError("minAmplitude","number between 0.001 and 1",$.minAmplitude)}if(!Q.defined($))this.options.blurSigma=-1;else if(Q.bool($))this.options.blurSigma=$?-1:0;else if(Q.number(P)&&Q.inRange(P,0.3,1000))this.options.blurSigma=P;else throw Q.invalidParameterError("sigma","number between 0.3 and 1000",P);return this}function R4($){if(!Q.defined($))this.options.dilateWidth=1;else if(Q.integer($)&&$>0)this.options.dilateWidth=$;else throw Q.invalidParameterError("dilate","positive integer",R4);return this}function J4($){if(!Q.defined($))this.options.erodeWidth=1;else if(Q.integer($)&&$>0)this.options.erodeWidth=$;else throw Q.invalidParameterError("erode","positive integer",J4);return this}function g5($){if(this.options.flatten=Q.bool($)?$:!0,Q.object($))this._setBackgroundColourOption("flattenBackground",$.background);return this}function u5(){return this.options.unflatten=!0,this}function l5($,P){if(!Q.defined($))this.options.gamma=2.2;else if(Q.number($)&&Q.inRange($,1,3))this.options.gamma=$;else throw Q.invalidParameterError("gamma","number between 1.0 and 3.0",$);if(!Q.defined(P))this.options.gammaOut=this.options.gamma;else if(Q.number(P)&&Q.inRange(P,1,3))this.options.gammaOut=P;else throw Q.invalidParameterError("gammaOut","number between 1.0 and 3.0",P);return this}function m5($){if(this.options.negate=Q.bool($)?$:!0,Q.plainObject($)&&"alpha"in $)if(!Q.bool($.alpha))throw Q.invalidParameterError("alpha","should be boolean value",$.alpha);else this.options.negateAlpha=$.alpha;return this}function r5($){if(Q.plainObject($)){if(Q.defined($.lower))if(Q.number($.lower)&&Q.inRange($.lower,0,99))this.options.normaliseLower=$.lower;else throw Q.invalidParameterError("lower","number between 0 and 99",$.lower);if(Q.defined($.upper))if(Q.number($.upper)&&Q.inRange($.upper,1,100))this.options.normaliseUpper=$.upper;else throw Q.invalidParameterError("upper","number between 1 and 100",$.upper)}if(this.options.normaliseLower>=this.options.normaliseUpper)throw Q.invalidParameterError("range","lower to be less than upper",`${this.options.normaliseLower} >= ${this.options.normaliseUpper}`);return this.options.normalise=!0,this}function a5($){return this.normalise($)}function e5($){if(Q.plainObject($)){if(Q.integer($.width)&&$.width>0)this.options.claheWidth=$.width;else throw Q.invalidParameterError("width","integer greater than zero",$.width);if(Q.integer($.height)&&$.height>0)this.options.claheHeight=$.height;else throw Q.invalidParameterError("height","integer greater than zero",$.height);if(Q.defined($.maxSlope))if(Q.integer($.maxSlope)&&Q.inRange($.maxSlope,0,100))this.options.claheMaxSlope=$.maxSlope;else throw Q.invalidParameterError("maxSlope","integer between 0 and 100",$.maxSlope)}else throw Q.invalidParameterError("options","plain object",$);return this}function n5($){if(!Q.object($)||!Array.isArray($.kernel)||!Q.integer($.width)||!Q.integer($.height)||!Q.inRange($.width,3,1001)||!Q.inRange($.height,3,1001)||$.height*$.width!==$.kernel.length)throw Error("Invalid convolution kernel");if(!Q.integer($.scale))$.scale=$.kernel.reduce((P,H)=>P+H,0);if($.scale<1)$.scale=1;if(!Q.integer($.offset))$.offset=0;return this.options.convKernel=$,this}function s5($,P){if(!Q.defined($))this.options.threshold=128;else if(Q.bool($))this.options.threshold=$?128:0;else if(Q.integer($)&&Q.inRange($,0,255))this.options.threshold=$;else throw Q.invalidParameterError("threshold","integer between 0 and 255",$);if(!Q.object(P)||P.greyscale===!0||P.grayscale===!0)this.options.thresholdGrayscale=!0;else this.options.thresholdGrayscale=!1;return this}function t5($,P,H){if(this.options.boolean=this._createInputDescriptor($,H),Q.string(P)&&Q.inArray(P,["and","or","eor"]))this.options.booleanOp=P;else throw Q.invalidParameterError("operator","one of: and, or, eor",P);return this}function p5($,P){if(!Q.defined($)&&Q.number(P))$=1;else if(Q.number($)&&!Q.defined(P))P=0;if(!Q.defined($))this.options.linearA=[];else if(Q.number($))this.options.linearA=[$];else if(Array.isArray($)&&$.length&&$.every(Q.number))this.options.linearA=$;else throw Q.invalidParameterError("a","number or array of numbers",$);if(!Q.defined(P))this.options.linearB=[];else if(Q.number(P))this.options.linearB=[P];else if(Array.isArray(P)&&P.length&&P.every(Q.number))this.options.linearB=P;else throw Q.invalidParameterError("b","number or array of numbers",P);if(this.options.linearA.length!==this.options.linearB.length)throw Error("Expected a and b to be arrays of the same length");return this}function i5($){if(!Array.isArray($))throw Q.invalidParameterError("inputMatrix","array",$);if($.length!==3&&$.length!==4)throw Q.invalidParameterError("inputMatrix","3x3 or 4x4 array",$.length);let P=$.flat().map(Number);if(P.length!==9&&P.length!==16)throw Q.invalidParameterError("inputMatrix","cardinality of 9 or 16",P.length);return this.options.recombMatrix=P,this}function o5($){if(!Q.plainObject($))throw Q.invalidParameterError("options","plain object",$);if("brightness"in $)if(Q.number($.brightness)&&$.brightness>=0)this.options.brightness=$.brightness;else throw Q.invalidParameterError("brightness","number above zero",$.brightness);if("saturation"in $)if(Q.number($.saturation)&&$.saturation>=0)this.options.saturation=$.saturation;else throw Q.invalidParameterError("saturation","number above zero",$.saturation);if("hue"in $)if(Q.integer($.hue))this.options.hue=$.hue%360;else throw Q.invalidParameterError("hue","number",$.hue);if("lightness"in $)if(Q.number($.lightness))this.options.lightness=$.lightness;else throw Q.invalidParameterError("lightness","number",$.lightness);return this}U4.exports=($)=>{Object.assign($.prototype,{autoOrient:k5,rotate:M5,flip:h5,flop:d5,affine:v5,sharpen:b5,erode:J4,dilate:R4,median:c5,blur:O5,flatten:g5,unflatten:u5,gamma:l5,negate:m5,normalise:r5,normalize:a5,clahe:e5,convolve:n5,threshold:s5,boolean:t5,linear:p5,recomb:i5,modulate:o5})}});var Y4=w((zR,Z4)=>{var{defineProperty:m1,getOwnPropertyDescriptor:$H,getOwnPropertyNames:PH}=Object,HH=Object.prototype.hasOwnProperty,qH=($,P)=>{for(var H in P)m1($,H,{get:P[H],enumerable:!0})},WH=($,P,H,q)=>{if(P&&typeof P==="object"||typeof P==="function"){for(let W of PH(P))if(!HH.call($,W)&&W!==H)m1($,W,{get:()=>P[W],enumerable:!(q=$H(P,W))||q.enumerable})}return $},RH=($)=>WH(m1({},"__esModule",{value:!0}),$),E4={};qH(E4,{default:()=>BH});Z4.exports=RH(E4);var e={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},N4=Object.create(null);for(let $ in e)if(Object.hasOwn(e,$))N4[e[$]]=$;var h={to:{},get:{}};h.get=function($){let P=$.slice(0,3).toLowerCase(),H,q;switch(P){case"hsl":{H=h.get.hsl($),q="hsl";break}case"hwb":{H=h.get.hwb($),q="hwb";break}default:{H=h.get.rgb($),q="rgb";break}}if(!H)return null;return{model:q,value:H}};h.get.rgb=function($){if(!$)return null;let P=/^#([a-f\d]{3,4})$/i,H=/^#([a-f\d]{6})([a-f\d]{2})?$/i,q=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/,W=/^rgba?\(\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/,R=/^(\w+)$/,J=[0,0,0,1],K,E,I;if(K=$.match(H)){I=K[2],K=K[1];for(E=0;E<3;E++){let Z=E*2;J[E]=Number.parseInt(K.slice(Z,Z+2),16)}if(I)J[3]=Number.parseInt(I,16)/255}else if(K=$.match(P)){K=K[1],I=K[3];for(E=0;E<3;E++)J[E]=Number.parseInt(K[E]+K[E],16);if(I)J[3]=Number.parseInt(I+I,16)/255}else if(K=$.match(q)){for(E=0;E<3;E++)J[E]=Number.parseInt(K[E+1],10);if(K[4])J[3]=K[5]?Number.parseFloat(K[4])*0.01:Number.parseFloat(K[4])}else if(K=$.match(W)){for(E=0;E<3;E++)J[E]=Math.round(Number.parseFloat(K[E+1])*2.55);if(K[4])J[3]=K[5]?Number.parseFloat(K[4])*0.01:Number.parseFloat(K[4])}else if(K=$.match(R)){if(K[1]==="transparent")return[0,0,0,0];if(!Object.hasOwn(e,K[1]))return null;return J=e[K[1]],J[3]=1,J}else return null;for(E=0;E<3;E++)J[E]=q0(J[E],0,255);return J[3]=q0(J[3],0,1),J};h.get.hsl=function($){if(!$)return null;let P=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[,|/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,H=$.match(P);if(H){let q=Number.parseFloat(H[4]),W=(Number.parseFloat(H[1])%360+360)%360,R=q0(Number.parseFloat(H[2]),0,100),J=q0(Number.parseFloat(H[3]),0,100),K=q0(Number.isNaN(q)?1:q,0,1);return[W,R,J,K]}return null};h.get.hwb=function($){if(!$)return null;let P=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*[\s,]\s*([+-]?[\d.]+)%\s*[\s,]\s*([+-]?[\d.]+)%\s*(?:[\s,]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,H=$.match(P);if(H){let q=Number.parseFloat(H[4]),W=(Number.parseFloat(H[1])%360+360)%360,R=q0(Number.parseFloat(H[2]),0,100),J=q0(Number.parseFloat(H[3]),0,100),K=q0(Number.isNaN(q)?1:q,0,1);return[W,R,J,K]}return null};h.to.hex=function(...$){return"#"+K1($[0])+K1($[1])+K1($[2])+($[3]<1?K1(Math.round($[3]*255)):"")};h.to.rgb=function(...$){return $.length<4||$[3]===1?"rgb("+Math.round($[0])+", "+Math.round($[1])+", "+Math.round($[2])+")":"rgba("+Math.round($[0])+", "+Math.round($[1])+", "+Math.round($[2])+", "+$[3]+")"};h.to.rgb.percent=function(...$){let P=Math.round($[0]/255*100),H=Math.round($[1]/255*100),q=Math.round($[2]/255*100);return $.length<4||$[3]===1?"rgb("+P+"%, "+H+"%, "+q+"%)":"rgba("+P+"%, "+H+"%, "+q+"%, "+$[3]+")"};h.to.hsl=function(...$){return $.length<4||$[3]===1?"hsl("+$[0]+", "+$[1]+"%, "+$[2]+"%)":"hsla("+$[0]+", "+$[1]+"%, "+$[2]+"%, "+$[3]+")"};h.to.hwb=function(...$){let P="";if($.length>=4&&$[3]!==1)P=", "+$[3];return"hwb("+$[0]+", "+$[1]+"%, "+$[2]+"%"+P+")"};h.to.keyword=function(...$){return N4[$.slice(0,3)]};function q0($,P,H){return Math.min(Math.max(P,$),H)}function K1($){let P=Math.round($).toString(16).toUpperCase();return P.length<2?"0"+P:P}var B0=h,Q4={};for(let $ of Object.keys(e))Q4[e[$]]=$;var Y={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},Q0=Y,p=0.008856451679035631;function V0($){let P=$>0.0031308?1.055*$**0.4166666666666667-0.055:$*12.92;return Math.min(Math.max(0,P),1)}function L0($){return $>0.04045?(($+0.055)/1.055)**2.4:$/12.92}for(let $ of Object.keys(Y)){if(!("channels"in Y[$]))throw Error("missing channels property: "+$);if(!("labels"in Y[$]))throw Error("missing channel labels property: "+$);if(Y[$].labels.length!==Y[$].channels)throw Error("channel and label counts mismatch: "+$);let{channels:P,labels:H}=Y[$];delete Y[$].channels,delete Y[$].labels,Object.defineProperty(Y[$],"channels",{value:P}),Object.defineProperty(Y[$],"labels",{value:H})}Y.rgb.hsl=function($){let P=$[0]/255,H=$[1]/255,q=$[2]/255,W=Math.min(P,H,q),R=Math.max(P,H,q),J=R-W,K,E;switch(R){case W:{K=0;break}case P:{K=(H-q)/J;break}case H:{K=2+(q-P)/J;break}case q:{K=4+(P-H)/J;break}}if(K=Math.min(K*60,360),K<0)K+=360;let I=(W+R)/2;if(R===W)E=0;else if(I<=0.5)E=J/(R+W);else E=J/(2-R-W);return[K,E*100,I*100]};Y.rgb.hsv=function($){let P,H,q,W,R,J=$[0]/255,K=$[1]/255,E=$[2]/255,I=Math.max(J,K,E),Z=I-Math.min(J,K,E),X=function(z){return(I-z)/6/Z+0.5};if(Z===0)W=0,R=0;else{switch(R=Z/I,P=X(J),H=X(K),q=X(E),I){case J:{W=q-H;break}case K:{W=0.3333333333333333+P-q;break}case E:{W=0.6666666666666666+H-P;break}}if(W<0)W+=1;else if(W>1)W-=1}return[W*360,R*100,I*100]};Y.rgb.hwb=function($){let P=$[0],H=$[1],q=$[2],W=Y.rgb.hsl($)[0],R=0.00392156862745098*Math.min(P,Math.min(H,q));return q=1-0.00392156862745098*Math.max(P,Math.max(H,q)),[W,R*100,q*100]};Y.rgb.oklab=function($){let P=L0($[0]/255),H=L0($[1]/255),q=L0($[2]/255),W=Math.cbrt(0.4122214708*P+0.5363325363*H+0.0514459929*q),R=Math.cbrt(0.2119034982*P+0.6806995451*H+0.1073969566*q),J=Math.cbrt(0.0883024619*P+0.2817188376*H+0.6299787005*q),K=0.2104542553*W+0.793617785*R-0.0040720468*J,E=1.9779984951*W-2.428592205*R+0.4505937099*J,I=0.0259040371*W+0.7827717662*R-0.808675766*J;return[K*100,E*100,I*100]};Y.rgb.cmyk=function($){let P=$[0]/255,H=$[1]/255,q=$[2]/255,W=Math.min(1-P,1-H,1-q),R=(1-P-W)/(1-W)||0,J=(1-H-W)/(1-W)||0,K=(1-q-W)/(1-W)||0;return[R*100,J*100,K*100,W*100]};function JH($,P){return($[0]-P[0])**2+($[1]-P[1])**2+($[2]-P[2])**2}Y.rgb.keyword=function($){let P=Q4[$];if(P)return P;let H=Number.POSITIVE_INFINITY,q;for(let W of Object.keys(e)){let R=e[W],J=JH($,R);if(J<H)H=J,q=W}return q};Y.keyword.rgb=function($){return e[$]};Y.rgb.xyz=function($){let P=L0($[0]/255),H=L0($[1]/255),q=L0($[2]/255),W=P*0.4124564+H*0.3575761+q*0.1804375,R=P*0.2126729+H*0.7151522+q*0.072175,J=P*0.0193339+H*0.119192+q*0.9503041;return[W*100,R*100,J*100]};Y.rgb.lab=function($){let P=Y.rgb.xyz($),H=P[0],q=P[1],W=P[2];H/=95.047,q/=100,W/=108.883,H=H>p?H**0.3333333333333333:7.787*H+0.13793103448275862,q=q>p?q**0.3333333333333333:7.787*q+0.13793103448275862,W=W>p?W**0.3333333333333333:7.787*W+0.13793103448275862;let R=116*q-16,J=500*(H-q),K=200*(q-W);return[R,J,K]};Y.hsl.rgb=function($){let P=$[0]/360,H=$[1]/100,q=$[2]/100,W,R;if(H===0)return R=q*255,[R,R,R];let J=q<0.5?q*(1+H):q+H-q*H,K=2*q-J,E=[0,0,0];for(let I=0;I<3;I++){if(W=P+0.3333333333333333*-(I-1),W<0)W++;if(W>1)W--;if(6*W<1)R=K+(J-K)*6*W;else if(2*W<1)R=J;else if(3*W<2)R=K+(J-K)*(0.6666666666666666-W)*6;else R=K;E[I]=R*255}return E};Y.hsl.hsv=function($){let P=$[0],H=$[1]/100,q=$[2]/100,W=H,R=Math.max(q,0.01);q*=2,H*=q<=1?q:2-q,W*=R<=1?R:2-R;let J=(q+H)/2,K=q===0?2*W/(R+W):2*H/(q+H);return[P,K*100,J*100]};Y.hsv.rgb=function($){let P=$[0]/60,H=$[1]/100,q=$[2]/100,W=Math.floor(P)%6,R=P-Math.floor(P),J=255*q*(1-H),K=255*q*(1-H*R),E=255*q*(1-H*(1-R));switch(q*=255,W){case 0:return[q,E,J];case 1:return[K,q,J];case 2:return[J,q,E];case 3:return[J,K,q];case 4:return[E,J,q];case 5:return[q,J,K]}};Y.hsv.hsl=function($){let P=$[0],H=$[1]/100,q=$[2]/100,W=Math.max(q,0.01),R,J;J=(2-H)*q;let K=(2-H)*W;return R=H*W,R/=K<=1?K:2-K,R=R||0,J/=2,[P,R*100,J*100]};Y.hwb.rgb=function($){let P=$[0]/360,H=$[1]/100,q=$[2]/100,W=H+q,R;if(W>1)H/=W,q/=W;let J=Math.floor(6*P),K=1-q;if(R=6*P-J,(J&1)!==0)R=1-R;let E=H+R*(K-H),I,Z,X;switch(J){default:case 6:case 0:{I=K,Z=E,X=H;break}case 1:{I=E,Z=K,X=H;break}case 2:{I=H,Z=K,X=E;break}case 3:{I=H,Z=E,X=K;break}case 4:{I=E,Z=H,X=K;break}case 5:{I=K,Z=H,X=E;break}}return[I*255,Z*255,X*255]};Y.cmyk.rgb=function($){let P=$[0]/100,H=$[1]/100,q=$[2]/100,W=$[3]/100,R=1-Math.min(1,P*(1-W)+W),J=1-Math.min(1,H*(1-W)+W),K=1-Math.min(1,q*(1-W)+W);return[R*255,J*255,K*255]};Y.xyz.rgb=function($){let P=$[0]/100,H=$[1]/100,q=$[2]/100,W,R,J;return W=P*3.2404542+H*-1.5371385+q*-0.4985314,R=P*-0.969266+H*1.8760108+q*0.041556,J=P*0.0556434+H*-0.2040259+q*1.0572252,W=V0(W),R=V0(R),J=V0(J),[W*255,R*255,J*255]};Y.xyz.lab=function($){let P=$[0],H=$[1],q=$[2];P/=95.047,H/=100,q/=108.883,P=P>p?P**0.3333333333333333:7.787*P+0.13793103448275862,H=H>p?H**0.3333333333333333:7.787*H+0.13793103448275862,q=q>p?q**0.3333333333333333:7.787*q+0.13793103448275862;let W=116*H-16,R=500*(P-H),J=200*(H-q);return[W,R,J]};Y.xyz.oklab=function($){let P=$[0]/100,H=$[1]/100,q=$[2]/100,W=Math.cbrt(0.8189330101*P+0.3618667424*H-0.1288597137*q),R=Math.cbrt(0.0329845436*P+0.9293118715*H+0.0361456387*q),J=Math.cbrt(0.0482003018*P+0.2643662691*H+0.633851707*q),K=0.2104542553*W+0.793617785*R-0.0040720468*J,E=1.9779984951*W-2.428592205*R+0.4505937099*J,I=0.0259040371*W+0.7827717662*R-0.808675766*J;return[K*100,E*100,I*100]};Y.oklab.oklch=function($){return Y.lab.lch($)};Y.oklab.xyz=function($){let P=$[0]/100,H=$[1]/100,q=$[2]/100,W=(0.999999998*P+0.396337792*H+0.215803758*q)**3,R=(1.000000008*P-0.105561342*H-0.063854175*q)**3,J=(1.000000055*P-0.089484182*H-1.291485538*q)**3,K=1.227013851*W-0.55779998*R+0.281256149*J,E=-0.040580178*W+1.11225687*R-0.071676679*J,I=-0.076381285*W-0.421481978*R+1.58616322*J;return[K*100,E*100,I*100]};Y.oklab.rgb=function($){let P=$[0]/100,H=$[1]/100,q=$[2]/100,W=(P+0.3963377774*H+0.2158037573*q)**3,R=(P-0.1055613458*H-0.0638541728*q)**3,J=(P-0.0894841775*H-1.291485548*q)**3,K=V0(4.0767416621*W-3.3077115913*R+0.2309699292*J),E=V0(-1.2684380046*W+2.6097574011*R-0.3413193965*J),I=V0(-0.0041960863*W-0.7034186147*R+1.707614701*J);return[K*255,E*255,I*255]};Y.oklch.oklab=function($){return Y.lch.lab($)};Y.lab.xyz=function($){let P=$[0],H=$[1],q=$[2],W,R,J;R=(P+16)/116,W=H/500+R,J=R-q/200;let K=R**3,E=W**3,I=J**3;return R=K>p?K:(R-0.13793103448275862)/7.787,W=E>p?E:(W-0.13793103448275862)/7.787,J=I>p?I:(J-0.13793103448275862)/7.787,W*=95.047,R*=100,J*=108.883,[W,R,J]};Y.lab.lch=function($){let P=$[0],H=$[1],q=$[2],W;if(W=Math.atan2(q,H)*360/2/Math.PI,W<0)W+=360;let J=Math.sqrt(H*H+q*q);return[P,J,W]};Y.lch.lab=function($){let P=$[0],H=$[1],W=$[2]/360*2*Math.PI,R=H*Math.cos(W),J=H*Math.sin(W);return[P,R,J]};Y.rgb.ansi16=function($,P=null){let[H,q,W]=$,R=P===null?Y.rgb.hsv($)[2]:P;if(R=Math.round(R/50),R===0)return 30;let J=30+(Math.round(W/255)<<2|Math.round(q/255)<<1|Math.round(H/255));if(R===2)J+=60;return J};Y.hsv.ansi16=function($){return Y.rgb.ansi16(Y.hsv.rgb($),$[2])};Y.rgb.ansi256=function($){let P=$[0],H=$[1],q=$[2];if(P>>4===H>>4&&H>>4===q>>4){if(P<8)return 16;if(P>248)return 231;return Math.round((P-8)/247*24)+232}return 16+36*Math.round(P/255*5)+6*Math.round(H/255*5)+Math.round(q/255*5)};Y.ansi16.rgb=function($){$=$[0];let P=$%10;if(P===0||P===7){if($>50)P+=3.5;return P=P/10.5*255,[P,P,P]}let H=(Math.trunc($>50)+1)*0.5,q=(P&1)*H*255,W=(P>>1&1)*H*255,R=(P>>2&1)*H*255;return[q,W,R]};Y.ansi256.rgb=function($){if($=$[0],$>=232){let R=($-232)*10+8;return[R,R,R]}$-=16;let P,H=Math.floor($/36)/5*255,q=Math.floor((P=$%36)/6)/5*255,W=P%6/5*255;return[H,q,W]};Y.rgb.hex=function($){let H=(((Math.round($[0])&255)<<16)+((Math.round($[1])&255)<<8)+(Math.round($[2])&255)).toString(16).toUpperCase();return"000000".slice(H.length)+H};Y.hex.rgb=function($){let P=$.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!P)return[0,0,0];let H=P[0];if(P[0].length===3)H=[...H].map((K)=>K+K).join("");let q=Number.parseInt(H,16),W=q>>16&255,R=q>>8&255,J=q&255;return[W,R,J]};Y.rgb.hcg=function($){let P=$[0]/255,H=$[1]/255,q=$[2]/255,W=Math.max(Math.max(P,H),q),R=Math.min(Math.min(P,H),q),J=W-R,K,E=J<1?R/(1-J):0;if(J<=0)K=0;else if(W===P)K=(H-q)/J%6;else if(W===H)K=2+(q-P)/J;else K=4+(P-H)/J;return K/=6,K%=1,[K*360,J*100,E*100]};Y.hsl.hcg=function($){let P=$[1]/100,H=$[2]/100,q=H<0.5?2*P*H:2*P*(1-H),W=0;if(q<1)W=(H-0.5*q)/(1-q);return[$[0],q*100,W*100]};Y.hsv.hcg=function($){let P=$[1]/100,H=$[2]/100,q=P*H,W=0;if(q<1)W=(H-q)/(1-q);return[$[0],q*100,W*100]};Y.hcg.rgb=function($){let P=$[0]/360,H=$[1]/100,q=$[2]/100;if(H===0)return[q*255,q*255,q*255];let W=[0,0,0],R=P%1*6,J=R%1,K=1-J,E=0;switch(Math.floor(R)){case 0:{W[0]=1,W[1]=J,W[2]=0;break}case 1:{W[0]=K,W[1]=1,W[2]=0;break}case 2:{W[0]=0,W[1]=1,W[2]=J;break}case 3:{W[0]=0,W[1]=K,W[2]=1;break}case 4:{W[0]=J,W[1]=0,W[2]=1;break}default:W[0]=1,W[1]=0,W[2]=K}return E=(1-H)*q,[(H*W[0]+E)*255,(H*W[1]+E)*255,(H*W[2]+E)*255]};Y.hcg.hsv=function($){let P=$[1]/100,H=$[2]/100,q=P+H*(1-P),W=0;if(q>0)W=P/q;return[$[0],W*100,q*100]};Y.hcg.hsl=function($){let P=$[1]/100,q=$[2]/100*(1-P)+0.5*P,W=0;if(q>0&&q<0.5)W=P/(2*q);else if(q>=0.5&&q<1)W=P/(2*(1-q));return[$[0],W*100,q*100]};Y.hcg.hwb=function($){let P=$[1]/100,H=$[2]/100,q=P+H*(1-P);return[$[0],(q-P)*100,(1-q)*100]};Y.hwb.hcg=function($){let P=$[1]/100,q=1-$[2]/100,W=q-P,R=0;if(W<1)R=(q-W)/(1-W);return[$[0],W*100,R*100]};Y.apple.rgb=function($){return[$[0]/65535*255,$[1]/65535*255,$[2]/65535*255]};Y.rgb.apple=function($){return[$[0]/255*65535,$[1]/255*65535,$[2]/255*65535]};Y.gray.rgb=function($){return[$[0]/100*255,$[0]/100*255,$[0]/100*255]};Y.gray.hsl=function($){return[0,0,$[0]]};Y.gray.hsv=Y.gray.hsl;Y.gray.hwb=function($){return[0,100,$[0]]};Y.gray.cmyk=function($){return[0,0,0,$[0]]};Y.gray.lab=function($){return[$[0],0,0]};Y.gray.hex=function($){let P=Math.round($[0]/100*255)&255,q=((P<<16)+(P<<8)+P).toString(16).toUpperCase();return"000000".slice(q.length)+q};Y.rgb.gray=function($){return[($[0]+$[1]+$[2])/3/255*100]};function UH(){let $={},P=Object.keys(Q0);for(let{length:H}=P,q=0;q<H;q++)$[P[q]]={distance:-1,parent:null};return $}function KH($){let P=UH(),H=[$];P[$].distance=0;while(H.length>0){let q=H.pop(),W=Object.keys(Q0[q]);for(let{length:R}=W,J=0;J<R;J++){let K=W[J],E=P[K];if(E.distance===-1)E.distance=P[q].distance+1,E.parent=q,H.unshift(K)}}return P}function EH($,P){return function(H){return P($(H))}}function NH($,P){let H=[P[$].parent,$],q=Q0[P[$].parent][$],W=P[$].parent;while(P[W].parent)H.unshift(P[W].parent),q=EH(Q0[P[W].parent][W],q),W=P[W].parent;return q.conversion=H,q}function QH($){let P=KH($),H={},q=Object.keys(P);for(let{length:W}=q,R=0;R<W;R++){let J=q[R];if(P[J].parent===null)continue;H[J]=NH(J,P)}return H}var IH=QH,w0={},ZH=Object.keys(Q0);function YH($){let P=function(...H){let q=H[0];if(q===void 0||q===null)return q;if(q.length>1)H=q;return $(H)};if("conversion"in $)P.conversion=$.conversion;return P}function jH($){let P=function(...H){let q=H[0];if(q===void 0||q===null)return q;if(q.length>1)H=q;let W=$(H);if(typeof W==="object")for(let{length:R}=W,J=0;J<R;J++)W[J]=Math.round(W[J]);return W};if("conversion"in $)P.conversion=$.conversion;return P}for(let $ of ZH){w0[$]={},Object.defineProperty(w0[$],"channels",{value:Q0[$].channels}),Object.defineProperty(w0[$],"labels",{value:Q0[$].labels});let P=IH($),H=Object.keys(P);for(let q of H){let W=P[q];w0[$][q]=jH(W),w0[$][q].raw=YH(W)}}var d=w0,I4=["keyword","gray","hex"],g1={};for(let $ of Object.keys(d))g1[[...d[$].labels].sort().join("")]=$;var u1={};function y($,P){if(!(this instanceof y))return new y($,P);if(P&&P in I4)P=null;if(P&&!(P in d))throw Error("Unknown model: "+P);let H,q;if($==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if($ instanceof y)this.model=$.model,this.color=[...$.color],this.valpha=$.valpha;else if(typeof $==="string"){let W=B0.get($);if(W===null)throw Error("Unable to parse color from string: "+$);this.model=W.model,q=d[this.model].channels,this.color=W.value.slice(0,q),this.valpha=typeof W.value[q]==="number"?W.value[q]:1}else if($.length>0){this.model=P||"rgb",q=d[this.model].channels;let W=Array.prototype.slice.call($,0,q);this.color=l1(W,q),this.valpha=typeof $[q]==="number"?$[q]:1}else if(typeof $==="number")this.model="rgb",this.color=[$>>16&255,$>>8&255,$&255],this.valpha=1;else{this.valpha=1;let W=Object.keys($);if("alpha"in $)W.splice(W.indexOf("alpha"),1),this.valpha=typeof $.alpha==="number"?$.alpha:0;let R=W.sort().join("");if(!(R in g1))throw Error("Unable to parse color from object: "+JSON.stringify($));this.model=g1[R];let{labels:J}=d[this.model],K=[];for(H=0;H<J.length;H++)K.push($[J[H]]);this.color=l1(K)}if(u1[this.model]){q=d[this.model].channels;for(H=0;H<q;H++){let W=u1[this.model][H];if(W)this.color[H]=W(this.color[H])}}if(this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze)Object.freeze(this)}y.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string($){let P=this.model in B0.to?this:this.rgb();P=P.round(typeof $==="number"?$:1);let H=P.valpha===1?P.color:[...P.color,this.valpha];return B0.to[P.model](...H)},percentString($){let P=this.rgb().round(typeof $==="number"?$:1),H=P.valpha===1?P.color:[...P.color,this.valpha];return B0.to.rgb.percent(...H)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){let $={},{channels:P}=d[this.model],{labels:H}=d[this.model];for(let q=0;q<P;q++)$[H[q]]=this.color[q];if(this.valpha!==1)$.alpha=this.valpha;return $},unitArray(){let $=this.rgb().color;if($[0]/=255,$[1]/=255,$[2]/=255,this.valpha!==1)$.push(this.valpha);return $},unitObject(){let $=this.rgb().object();if($.r/=255,$.g/=255,$.b/=255,this.valpha!==1)$.alpha=this.valpha;return $},round($){return $=Math.max($||0,0),new y([...this.color.map(AH($)),this.valpha],this.model)},alpha($){if($!==void 0)return new y([...this.color,Math.max(0,Math.min(1,$))],this.model);return this.valpha},red:T("rgb",0,C(255)),green:T("rgb",1,C(255)),blue:T("rgb",2,C(255)),hue:T(["hsl","hsv","hsl","hwb","hcg"],0,($)=>($%360+360)%360),saturationl:T("hsl",1,C(100)),lightness:T("hsl",2,C(100)),saturationv:T("hsv",1,C(100)),value:T("hsv",2,C(100)),chroma:T("hcg",1,C(100)),gray:T("hcg",2,C(100)),white:T("hwb",1,C(100)),wblack:T("hwb",2,C(100)),cyan:T("cmyk",0,C(100)),magenta:T("cmyk",1,C(100)),yellow:T("cmyk",2,C(100)),black:T("cmyk",3,C(100)),x:T("xyz",0,C(95.047)),y:T("xyz",1,C(100)),z:T("xyz",2,C(108.833)),l:T("lab",0,C(100)),a:T("lab",1),b:T("lab",2),keyword($){if($!==void 0)return new y($);return d[this.model].keyword(this.color)},hex($){if($!==void 0)return new y($);return B0.to.hex(...this.rgb().round().color)},hexa($){if($!==void 0)return new y($);let P=this.rgb().round().color,H=Math.round(this.valpha*255).toString(16).toUpperCase();if(H.length===1)H="0"+H;return B0.to.hex(...P)+H},rgbNumber(){let $=this.rgb().color;return($[0]&255)<<16|($[1]&255)<<8|$[2]&255},luminosity(){let $=this.rgb().color,P=[];for(let[H,q]of $.entries()){let W=q/255;P[H]=W<=0.04045?W/12.92:((W+0.055)/1.055)**2.4}return 0.2126*P[0]+0.7152*P[1]+0.0722*P[2]},contrast($){let P=this.luminosity(),H=$.luminosity();if(P>H)return(P+0.05)/(H+0.05);return(H+0.05)/(P+0.05)},level($){let P=this.contrast($);if(P>=7)return"AAA";return P>=4.5?"AA":""},isDark(){let $=this.rgb().color;return($[0]*2126+$[1]*7152+$[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){let $=this.rgb();for(let P=0;P<3;P++)$.color[P]=255-$.color[P];return $},lighten($){let P=this.hsl();return P.color[2]+=P.color[2]*$,P},darken($){let P=this.hsl();return P.color[2]-=P.color[2]*$,P},saturate($){let P=this.hsl();return P.color[1]+=P.color[1]*$,P},desaturate($){let P=this.hsl();return P.color[1]-=P.color[1]*$,P},whiten($){let P=this.hwb();return P.color[1]+=P.color[1]*$,P},blacken($){let P=this.hwb();return P.color[2]+=P.color[2]*$,P},grayscale(){let $=this.rgb().color,P=$[0]*0.3+$[1]*0.59+$[2]*0.11;return y.rgb(P,P,P)},fade($){return this.alpha(this.valpha-this.valpha*$)},opaquer($){return this.alpha(this.valpha+this.valpha*$)},rotate($){let P=this.hsl(),H=P.color[0];return H=(H+$)%360,H=H<0?360+H:H,P.color[0]=H,P},mix($,P){if(!$||!$.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof $);let H=$.rgb(),q=this.rgb(),W=P===void 0?0.5:P,R=2*W-1,J=H.alpha()-q.alpha(),K=((R*J===-1?R:(R+J)/(1+R*J))+1)/2,E=1-K;return y.rgb(K*H.red()+E*q.red(),K*H.green()+E*q.green(),K*H.blue()+E*q.blue(),H.alpha()*W+q.alpha()*(1-W))}};for(let $ of Object.keys(d)){if(I4.includes($))continue;let{channels:P}=d[$];y.prototype[$]=function(...H){if(this.model===$)return new y(this);if(H.length>0)return new y(H,$);return new y([...XH(d[this.model][$].raw(this.color)),this.valpha],$)},y[$]=function(...H){let q=H[0];if(typeof q==="number")q=l1(H,P);return new y(q,$)}}function GH($,P){return Number($.toFixed(P))}function AH($){return function(P){return GH(P,$)}}function T($,P,H){$=Array.isArray($)?$:[$];for(let q of $)(u1[q]||=[])[P]=H;return $=$[0],function(q){let W;if(q!==void 0){if(H)q=H(q);return W=this[$](),W.color[P]=q,W}if(W=this[$]().color[P],H)W=H(W);return W}}function C($){return function(P){return Math.max(0,Math.min($,P))}}function XH($){return Array.isArray($)?$:[$]}function l1($,P){for(let H=0;H<P;H++)if(typeof $[H]!=="number")$[H]=0;return $}var BH=y});var G4=w((DR,j4)=>{j4.exports=Y4().default});var w4=w((fR,B4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var wH=G4(),i=u(),A4={multiband:"multiband","b-w":"b-w",bw:"b-w",cmyk:"cmyk",srgb:"srgb"};function VH($){return this._setBackgroundColourOption("tint",$),this}function LH($){return this.options.greyscale=i.bool($)?$:!0,this}function zH($){return this.greyscale($)}function DH($){if(!i.string($))throw i.invalidParameterError("colourspace","string",$);return this.options.colourspacePipeline=$,this}function fH($){return this.pipelineColourspace($)}function TH($){if(!i.string($))throw i.invalidParameterError("colourspace","string",$);return this.options.colourspace=$,this}function FH($){return this.toColourspace($)}function X4($){if(i.object($)||i.string($)&&$.length>=3&&$.length<=200){let P=wH($);return[P.red(),P.green(),P.blue(),Math.round(P.alpha()*255)]}else throw i.invalidParameterError("background","object or string",$)}function CH($,P){if(i.defined(P))this.options[$]=X4(P)}B4.exports=($)=>{Object.assign($.prototype,{tint:VH,greyscale:LH,grayscale:zH,pipelineColourspace:DH,pipelineColorspace:fH,toColourspace:TH,toColorspace:FH,_getBackgroundColourOption:X4,_setBackgroundColourOption:CH}),$.colourspace=A4,$.colorspace=A4}});var L4=w((TR,V4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var n=u(),yH={and:"and",or:"or",eor:"eor"};function xH(){return this.options.removeAlpha=!0,this}function SH($){if(n.defined($))if(n.number($)&&n.inRange($,0,1))this.options.ensureAlpha=$;else throw n.invalidParameterError("alpha","number between 0 and 1",$);else this.options.ensureAlpha=1;return this}function _H($){let P={red:0,green:1,blue:2,alpha:3};if(Object.keys(P).includes($))$=P[$];if(n.integer($)&&n.inRange($,0,4))this.options.extractChannel=$;else throw n.invalidParameterError("channel","integer or one of: red, green, blue, alpha",$);return this}function MH($,P){if(Array.isArray($))$.forEach(function(H){this.options.joinChannelIn.push(this._createInputDescriptor(H,P))},this);else this.options.joinChannelIn.push(this._createInputDescriptor($,P));return this}function kH($){if(n.string($)&&n.inArray($,["and","or","eor"]))this.options.bandBoolOp=$;else throw n.invalidParameterError("boolOp","one of: and, or, eor",$);return this}V4.exports=($)=>{Object.assign($.prototype,{removeAlpha:xH,ensureAlpha:SH,extractChannel:_H,joinChannel:MH,bandbool:kH}),$.bool=yH}});var F4=w((FR,T4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var r1=f("path"),U=u(),z0=d0(),z4=new Map([["heic","heif"],["heif","heif"],["avif","avif"],["jpeg","jpeg"],["jpg","jpeg"],["jpe","jpeg"],["tile","tile"],["dz","tile"],["png","png"],["raw","raw"],["tiff","tiff"],["tif","tiff"],["webp","webp"],["gif","gif"],["jp2","jp2"],["jpx","jp2"],["j2k","jp2"],["j2c","jp2"],["jxl","jxl"]]),hH=/\.(jp[2x]|j2[kc])$/i,D4=()=>Error("JP2 output requires libvips with support for OpenJPEG"),f4=($)=>1<<31-Math.clz32(Math.ceil(Math.log2($)));function dH($,P){let H;if(!U.string($))H=Error("Missing output file path");else if(U.string(this.options.input.file)&&r1.resolve(this.options.input.file)===r1.resolve($))H=Error("Cannot use same file for input and output");else if(hH.test(r1.extname($))&&!this.constructor.format.jp2k.output.file)H=D4();if(H)if(U.fn(P))P(H);else return Promise.reject(H);else{this.options.fileOut=$;let q=Error();return this._pipeline(P,q)}return this}function vH($,P){if(U.object($))this._setBooleanOption("resolveWithObject",$.resolveWithObject);else if(this.options.resolveWithObject)this.options.resolveWithObject=!1;this.options.fileOut="";let H=Error();return this._pipeline(U.fn($)?$:P,H)}function bH(){return this.options.keepMetadata|=1,this}function cH($){if(U.object($))for(let[P,H]of Object.entries($))if(U.object(H))for(let[q,W]of Object.entries(H))if(U.string(W))this.options.withExif[`exif-${P.toLowerCase()}-${q}`]=W;else throw U.invalidParameterError(`${P}.${q}`,"string",W);else throw U.invalidParameterError(P,"object",H);else throw U.invalidParameterError("exif","object",$);return this.options.withExifMerge=!1,this.keepExif()}function OH($){return this.withExif($),this.options.withExifMerge=!0,this}function gH(){return this.options.keepMetadata|=8,this}function uH($,P){if(U.string($))this.options.withIccProfile=$;else throw U.invalidParameterError("icc","string",$);if(this.keepIccProfile(),U.object(P)){if(U.defined(P.attach))if(U.bool(P.attach)){if(!P.attach)this.options.keepMetadata&=-9}else throw U.invalidParameterError("attach","boolean",P.attach)}return this}function lH(){return this.options.keepMetadata|=2,this}function mH($){if(U.string($)&&$.length>0)this.options.withXmp=$,this.options.keepMetadata|=2;else throw U.invalidParameterError("xmp","non-empty string",$);return this}function rH(){return this.options.keepMetadata=31,this}function aH($){if(this.keepMetadata(),this.withIccProfile("srgb"),U.object($)){if(U.defined($.orientation))if(U.integer($.orientation)&&U.inRange($.orientation,1,8))this.options.withMetadataOrientation=$.orientation;else throw U.invalidParameterError("orientation","integer between 1 and 8",$.orientation);if(U.defined($.density))if(U.number($.density)&&$.density>0)this.options.withMetadataDensity=$.density;else throw U.invalidParameterError("density","positive number",$.density);if(U.defined($.icc))this.withIccProfile($.icc);if(U.defined($.exif))this.withExifMerge($.exif)}return this}function eH($,P){let H=z4.get((U.object($)&&U.string($.id)?$.id:$).toLowerCase());if(!H)throw U.invalidParameterError("format",`one of: ${[...z4.keys()].join(", ")}`,$);return this[H](P)}function nH($){if(U.object($)){if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,1,100))this.options.jpegQuality=$.quality;else throw U.invalidParameterError("quality","integer between 1 and 100",$.quality);if(U.defined($.progressive))this._setBooleanOption("jpegProgressive",$.progressive);if(U.defined($.chromaSubsampling))if(U.string($.chromaSubsampling)&&U.inArray($.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jpegChromaSubsampling=$.chromaSubsampling;else throw U.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",$.chromaSubsampling);let P=U.bool($.optimizeCoding)?$.optimizeCoding:$.optimiseCoding;if(U.defined(P))this._setBooleanOption("jpegOptimiseCoding",P);if(U.defined($.mozjpeg))if(U.bool($.mozjpeg)){if($.mozjpeg)this.options.jpegTrellisQuantisation=!0,this.options.jpegOvershootDeringing=!0,this.options.jpegOptimiseScans=!0,this.options.jpegProgressive=!0,this.options.jpegQuantisationTable=3}else throw U.invalidParameterError("mozjpeg","boolean",$.mozjpeg);let H=U.bool($.trellisQuantization)?$.trellisQuantization:$.trellisQuantisation;if(U.defined(H))this._setBooleanOption("jpegTrellisQuantisation",H);if(U.defined($.overshootDeringing))this._setBooleanOption("jpegOvershootDeringing",$.overshootDeringing);let q=U.bool($.optimizeScans)?$.optimizeScans:$.optimiseScans;if(U.defined(q)){if(this._setBooleanOption("jpegOptimiseScans",q),q)this.options.jpegProgressive=!0}let W=U.number($.quantizationTable)?$.quantizationTable:$.quantisationTable;if(U.defined(W))if(U.integer(W)&&U.inRange(W,0,8))this.options.jpegQuantisationTable=W;else throw U.invalidParameterError("quantisationTable","integer between 0 and 8",W)}return this._updateFormatOut("jpeg",$)}function sH($){if(U.object($)){if(U.defined($.progressive))this._setBooleanOption("pngProgressive",$.progressive);if(U.defined($.compressionLevel))if(U.integer($.compressionLevel)&&U.inRange($.compressionLevel,0,9))this.options.pngCompressionLevel=$.compressionLevel;else throw U.invalidParameterError("compressionLevel","integer between 0 and 9",$.compressionLevel);if(U.defined($.adaptiveFiltering))this._setBooleanOption("pngAdaptiveFiltering",$.adaptiveFiltering);let P=$.colours||$.colors;if(U.defined(P))if(U.integer(P)&&U.inRange(P,2,256))this.options.pngBitdepth=f4(P);else throw U.invalidParameterError("colours","integer between 2 and 256",P);if(U.defined($.palette))this._setBooleanOption("pngPalette",$.palette);else if([$.quality,$.effort,$.colours,$.colors,$.dither].some(U.defined))this._setBooleanOption("pngPalette",!0);if(this.options.pngPalette){if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,0,100))this.options.pngQuality=$.quality;else throw U.invalidParameterError("quality","integer between 0 and 100",$.quality);if(U.defined($.effort))if(U.integer($.effort)&&U.inRange($.effort,1,10))this.options.pngEffort=$.effort;else throw U.invalidParameterError("effort","integer between 1 and 10",$.effort);if(U.defined($.dither))if(U.number($.dither)&&U.inRange($.dither,0,1))this.options.pngDither=$.dither;else throw U.invalidParameterError("dither","number between 0.0 and 1.0",$.dither)}}return this._updateFormatOut("png",$)}function tH($){if(U.object($)){if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,1,100))this.options.webpQuality=$.quality;else throw U.invalidParameterError("quality","integer between 1 and 100",$.quality);if(U.defined($.alphaQuality))if(U.integer($.alphaQuality)&&U.inRange($.alphaQuality,0,100))this.options.webpAlphaQuality=$.alphaQuality;else throw U.invalidParameterError("alphaQuality","integer between 0 and 100",$.alphaQuality);if(U.defined($.lossless))this._setBooleanOption("webpLossless",$.lossless);if(U.defined($.nearLossless))this._setBooleanOption("webpNearLossless",$.nearLossless);if(U.defined($.smartSubsample))this._setBooleanOption("webpSmartSubsample",$.smartSubsample);if(U.defined($.smartDeblock))this._setBooleanOption("webpSmartDeblock",$.smartDeblock);if(U.defined($.preset))if(U.string($.preset)&&U.inArray($.preset,["default","photo","picture","drawing","icon","text"]))this.options.webpPreset=$.preset;else throw U.invalidParameterError("preset","one of: default, photo, picture, drawing, icon, text",$.preset);if(U.defined($.effort))if(U.integer($.effort)&&U.inRange($.effort,0,6))this.options.webpEffort=$.effort;else throw U.invalidParameterError("effort","integer between 0 and 6",$.effort);if(U.defined($.minSize))this._setBooleanOption("webpMinSize",$.minSize);if(U.defined($.mixed))this._setBooleanOption("webpMixed",$.mixed)}return a1($,this.options),this._updateFormatOut("webp",$)}function pH($){if(U.object($)){if(U.defined($.reuse))this._setBooleanOption("gifReuse",$.reuse);if(U.defined($.progressive))this._setBooleanOption("gifProgressive",$.progressive);let P=$.colours||$.colors;if(U.defined(P))if(U.integer(P)&&U.inRange(P,2,256))this.options.gifBitdepth=f4(P);else throw U.invalidParameterError("colours","integer between 2 and 256",P);if(U.defined($.effort))if(U.number($.effort)&&U.inRange($.effort,1,10))this.options.gifEffort=$.effort;else throw U.invalidParameterError("effort","integer between 1 and 10",$.effort);if(U.defined($.dither))if(U.number($.dither)&&U.inRange($.dither,0,1))this.options.gifDither=$.dither;else throw U.invalidParameterError("dither","number between 0.0 and 1.0",$.dither);if(U.defined($.interFrameMaxError))if(U.number($.interFrameMaxError)&&U.inRange($.interFrameMaxError,0,32))this.options.gifInterFrameMaxError=$.interFrameMaxError;else throw U.invalidParameterError("interFrameMaxError","number between 0.0 and 32.0",$.interFrameMaxError);if(U.defined($.interPaletteMaxError))if(U.number($.interPaletteMaxError)&&U.inRange($.interPaletteMaxError,0,256))this.options.gifInterPaletteMaxError=$.interPaletteMaxError;else throw U.invalidParameterError("interPaletteMaxError","number between 0.0 and 256.0",$.interPaletteMaxError);if(U.defined($.keepDuplicateFrames))if(U.bool($.keepDuplicateFrames))this._setBooleanOption("gifKeepDuplicateFrames",$.keepDuplicateFrames);else throw U.invalidParameterError("keepDuplicateFrames","boolean",$.keepDuplicateFrames)}return a1($,this.options),this._updateFormatOut("gif",$)}function iH($){if(!this.constructor.format.jp2k.output.buffer)throw D4();if(U.object($)){if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,1,100))this.options.jp2Quality=$.quality;else throw U.invalidParameterError("quality","integer between 1 and 100",$.quality);if(U.defined($.lossless))if(U.bool($.lossless))this.options.jp2Lossless=$.lossless;else throw U.invalidParameterError("lossless","boolean",$.lossless);if(U.defined($.tileWidth))if(U.integer($.tileWidth)&&U.inRange($.tileWidth,1,32768))this.options.jp2TileWidth=$.tileWidth;else throw U.invalidParameterError("tileWidth","integer between 1 and 32768",$.tileWidth);if(U.defined($.tileHeight))if(U.integer($.tileHeight)&&U.inRange($.tileHeight,1,32768))this.options.jp2TileHeight=$.tileHeight;else throw U.invalidParameterError("tileHeight","integer between 1 and 32768",$.tileHeight);if(U.defined($.chromaSubsampling))if(U.string($.chromaSubsampling)&&U.inArray($.chromaSubsampling,["4:2:0","4:4:4"]))this.options.jp2ChromaSubsampling=$.chromaSubsampling;else throw U.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",$.chromaSubsampling)}return this._updateFormatOut("jp2",$)}function a1($,P){if(U.object($)&&U.defined($.loop))if(U.integer($.loop)&&U.inRange($.loop,0,65535))P.loop=$.loop;else throw U.invalidParameterError("loop","integer between 0 and 65535",$.loop);if(U.object($)&&U.defined($.delay))if(U.integer($.delay)&&U.inRange($.delay,0,65535))P.delay=[$.delay];else if(Array.isArray($.delay)&&$.delay.every(U.integer)&&$.delay.every((H)=>U.inRange(H,0,65535)))P.delay=$.delay;else throw U.invalidParameterError("delay","integer or an array of integers between 0 and 65535",$.delay)}function oH($){if(U.object($)){if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,1,100))this.options.tiffQuality=$.quality;else throw U.invalidParameterError("quality","integer between 1 and 100",$.quality);if(U.defined($.bitdepth))if(U.integer($.bitdepth)&&U.inArray($.bitdepth,[1,2,4,8]))this.options.tiffBitdepth=$.bitdepth;else throw U.invalidParameterError("bitdepth","1, 2, 4 or 8",$.bitdepth);if(U.defined($.tile))this._setBooleanOption("tiffTile",$.tile);if(U.defined($.tileWidth))if(U.integer($.tileWidth)&&$.tileWidth>0)this.options.tiffTileWidth=$.tileWidth;else throw U.invalidParameterError("tileWidth","integer greater than zero",$.tileWidth);if(U.defined($.tileHeight))if(U.integer($.tileHeight)&&$.tileHeight>0)this.options.tiffTileHeight=$.tileHeight;else throw U.invalidParameterError("tileHeight","integer greater than zero",$.tileHeight);if(U.defined($.miniswhite))this._setBooleanOption("tiffMiniswhite",$.miniswhite);if(U.defined($.pyramid))this._setBooleanOption("tiffPyramid",$.pyramid);if(U.defined($.xres))if(U.number($.xres)&&$.xres>0)this.options.tiffXres=$.xres;else throw U.invalidParameterError("xres","number greater than zero",$.xres);if(U.defined($.yres))if(U.number($.yres)&&$.yres>0)this.options.tiffYres=$.yres;else throw U.invalidParameterError("yres","number greater than zero",$.yres);if(U.defined($.compression))if(U.string($.compression)&&U.inArray($.compression,["none","jpeg","deflate","packbits","ccittfax4","lzw","webp","zstd","jp2k"]))this.options.tiffCompression=$.compression;else throw U.invalidParameterError("compression","one of: none, jpeg, deflate, packbits, ccittfax4, lzw, webp, zstd, jp2k",$.compression);if(U.defined($.bigtiff))this._setBooleanOption("tiffBigtiff",$.bigtiff);if(U.defined($.predictor))if(U.string($.predictor)&&U.inArray($.predictor,["none","horizontal","float"]))this.options.tiffPredictor=$.predictor;else throw U.invalidParameterError("predictor","one of: none, horizontal, float",$.predictor);if(U.defined($.resolutionUnit))if(U.string($.resolutionUnit)&&U.inArray($.resolutionUnit,["inch","cm"]))this.options.tiffResolutionUnit=$.resolutionUnit;else throw U.invalidParameterError("resolutionUnit","one of: inch, cm",$.resolutionUnit)}return this._updateFormatOut("tiff",$)}function $q($){return this.heif({...$,compression:"av1"})}function Pq($){if(U.object($)){if(U.string($.compression)&&U.inArray($.compression,["av1","hevc"]))this.options.heifCompression=$.compression;else throw U.invalidParameterError("compression","one of: av1, hevc",$.compression);if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,1,100))this.options.heifQuality=$.quality;else throw U.invalidParameterError("quality","integer between 1 and 100",$.quality);if(U.defined($.lossless))if(U.bool($.lossless))this.options.heifLossless=$.lossless;else throw U.invalidParameterError("lossless","boolean",$.lossless);if(U.defined($.effort))if(U.integer($.effort)&&U.inRange($.effort,0,9))this.options.heifEffort=$.effort;else throw U.invalidParameterError("effort","integer between 0 and 9",$.effort);if(U.defined($.chromaSubsampling))if(U.string($.chromaSubsampling)&&U.inArray($.chromaSubsampling,["4:2:0","4:4:4"]))this.options.heifChromaSubsampling=$.chromaSubsampling;else throw U.invalidParameterError("chromaSubsampling","one of: 4:2:0, 4:4:4",$.chromaSubsampling);if(U.defined($.bitdepth))if(U.integer($.bitdepth)&&U.inArray($.bitdepth,[8,10,12])){if($.bitdepth!==8&&this.constructor.versions.heif)throw U.invalidParameterError("bitdepth when using prebuilt binaries",8,$.bitdepth);this.options.heifBitdepth=$.bitdepth}else throw U.invalidParameterError("bitdepth","8, 10 or 12",$.bitdepth)}else throw U.invalidParameterError("options","Object",$);return this._updateFormatOut("heif",$)}function Hq($){if(U.object($)){if(U.defined($.quality))if(U.integer($.quality)&&U.inRange($.quality,1,100))this.options.jxlDistance=$.quality>=30?0.1+(100-$.quality)*0.09:0.017666666666666667*$.quality*$.quality-1.15*$.quality+25;else throw U.invalidParameterError("quality","integer between 1 and 100",$.quality);else if(U.defined($.distance))if(U.number($.distance)&&U.inRange($.distance,0,15))this.options.jxlDistance=$.distance;else throw U.invalidParameterError("distance","number between 0.0 and 15.0",$.distance);if(U.defined($.decodingTier))if(U.integer($.decodingTier)&&U.inRange($.decodingTier,0,4))this.options.jxlDecodingTier=$.decodingTier;else throw U.invalidParameterError("decodingTier","integer between 0 and 4",$.decodingTier);if(U.defined($.lossless))if(U.bool($.lossless))this.options.jxlLossless=$.lossless;else throw U.invalidParameterError("lossless","boolean",$.lossless);if(U.defined($.effort))if(U.integer($.effort)&&U.inRange($.effort,1,9))this.options.jxlEffort=$.effort;else throw U.invalidParameterError("effort","integer between 1 and 9",$.effort)}return a1($,this.options),this._updateFormatOut("jxl",$)}function qq($){if(U.object($)){if(U.defined($.depth))if(U.string($.depth)&&U.inArray($.depth,["char","uchar","short","ushort","int","uint","float","complex","double","dpcomplex"]))this.options.rawDepth=$.depth;else throw U.invalidParameterError("depth","one of: char, uchar, short, ushort, int, uint, float, complex, double, dpcomplex",$.depth)}return this._updateFormatOut("raw")}function Wq($){if(U.object($)){if(U.defined($.size))if(U.integer($.size)&&U.inRange($.size,1,8192))this.options.tileSize=$.size;else throw U.invalidParameterError("size","integer between 1 and 8192",$.size);if(U.defined($.overlap))if(U.integer($.overlap)&&U.inRange($.overlap,0,8192)){if($.overlap>this.options.tileSize)throw U.invalidParameterError("overlap",`<= size (${this.options.tileSize})`,$.overlap);this.options.tileOverlap=$.overlap}else throw U.invalidParameterError("overlap","integer between 0 and 8192",$.overlap);if(U.defined($.container))if(U.string($.container)&&U.inArray($.container,["fs","zip"]))this.options.tileContainer=$.container;else throw U.invalidParameterError("container","one of: fs, zip",$.container);if(U.defined($.layout))if(U.string($.layout)&&U.inArray($.layout,["dz","google","iiif","iiif3","zoomify"]))this.options.tileLayout=$.layout;else throw U.invalidParameterError("layout","one of: dz, google, iiif, iiif3, zoomify",$.layout);if(U.defined($.angle))if(U.integer($.angle)&&!($.angle%90))this.options.tileAngle=$.angle;else throw U.invalidParameterError("angle","positive/negative multiple of 90",$.angle);if(this._setBackgroundColourOption("tileBackground",$.background),U.defined($.depth))if(U.string($.depth)&&U.inArray($.depth,["onepixel","onetile","one"]))this.options.tileDepth=$.depth;else throw U.invalidParameterError("depth","one of: onepixel, onetile, one",$.depth);if(U.defined($.skipBlanks))if(U.integer($.skipBlanks)&&U.inRange($.skipBlanks,-1,65535))this.options.tileSkipBlanks=$.skipBlanks;else throw U.invalidParameterError("skipBlanks","integer between -1 and 255/65535",$.skipBlanks);else if(U.defined($.layout)&&$.layout==="google")this.options.tileSkipBlanks=5;let P=U.bool($.center)?$.center:$.centre;if(U.defined(P))this._setBooleanOption("tileCentre",P);if(U.defined($.id))if(U.string($.id))this.options.tileId=$.id;else throw U.invalidParameterError("id","string",$.id);if(U.defined($.basename))if(U.string($.basename))this.options.tileBasename=$.basename;else throw U.invalidParameterError("basename","string",$.basename)}if(U.inArray(this.options.formatOut,["jpeg","png","webp"]))this.options.tileFormat=this.options.formatOut;else if(this.options.formatOut!=="input")throw U.invalidParameterError("format","one of: jpeg, png, webp",this.options.formatOut);return this._updateFormatOut("dz")}function Rq($){if(!U.plainObject($))throw U.invalidParameterError("options","object",$);if(U.integer($.seconds)&&U.inRange($.seconds,0,3600))this.options.timeoutSeconds=$.seconds;else throw U.invalidParameterError("seconds","integer between 0 and 3600",$.seconds);return this}function Jq($,P){if(!(U.object(P)&&P.force===!1))this.options.formatOut=$;return this}function Uq($,P){if(U.bool(P))this.options[$]=P;else throw U.invalidParameterError($,"boolean",P)}function Kq(){if(!this.options.streamOut){this.options.streamOut=!0;let $=Error();this._pipeline(void 0,$)}}function Eq($,P){if(typeof $==="function"){if(this._isStreamInput())this.on("finish",()=>{this._flattenBufferIn(),z0.pipeline(this.options,(H,q,W)=>{if(H)$(U.nativeError(H,P));else $(null,q,W)})});else z0.pipeline(this.options,(H,q,W)=>{if(H)$(U.nativeError(H,P));else $(null,q,W)});return this}else if(this.options.streamOut){if(this._isStreamInput()){if(this.once("finish",()=>{this._flattenBufferIn(),z0.pipeline(this.options,(H,q,W)=>{if(H)this.emit("error",U.nativeError(H,P));else this.emit("info",W),this.push(q);this.push(null),this.on("end",()=>this.emit("close"))})}),this.streamInFinished)this.emit("finish")}else z0.pipeline(this.options,(H,q,W)=>{if(H)this.emit("error",U.nativeError(H,P));else this.emit("info",W),this.push(q);this.push(null),this.on("end",()=>this.emit("close"))});return this}else if(this._isStreamInput())return new Promise((H,q)=>{this.once("finish",()=>{this._flattenBufferIn(),z0.pipeline(this.options,(W,R,J)=>{if(W)q(U.nativeError(W,P));else if(this.options.resolveWithObject)H({data:R,info:J});else H(R)})})});else return new Promise((H,q)=>{z0.pipeline(this.options,(W,R,J)=>{if(W)q(U.nativeError(W,P));else if(this.options.resolveWithObject)H({data:R,info:J});else H(R)})})}T4.exports=($)=>{Object.assign($.prototype,{toFile:dH,toBuffer:vH,keepExif:bH,withExif:cH,withExifMerge:OH,keepIccProfile:gH,withIccProfile:uH,keepXmp:lH,withXmp:mH,keepMetadata:rH,withMetadata:aH,toFormat:eH,jpeg:nH,jp2:iH,png:sH,webp:tH,tiff:oH,avif:$q,heif:Pq,jxl:Hq,gif:pH,raw:qq,tile:Wq,timeout:Rq,_updateFormatOut:Jq,_setBooleanOption:Uq,_read:Kq,_pipeline:Eq})}});var S4=w((CR,x4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var Nq=f("events"),E1=s0(),c=u(),{runtimePlatformArch:Qq}=h1(),M=d0(),C4=Qq(),e1=M.libvipsVersion(),W0=M.format();W0.heif.output.alias=["avif","heic"];W0.jpeg.output.alias=["jpe","jpg"];W0.tiff.output.alias=["tif"];W0.jp2k.output.alias=["j2c","j2k","jp2","jpx"];var Iq={nearest:"nearest",bilinear:"bilinear",bicubic:"bicubic",locallyBoundedBicubic:"lbb",nohalo:"nohalo",vertexSplitQuadraticBasisSpline:"vsqbs"},D0={vips:e1.semver};if(!e1.isGlobal)if(!e1.isWasm)try{D0=f(`@img/sharp-${C4}/versions`)}catch($){try{D0=f(`@img/sharp-libvips-${C4}/versions`)}catch(P){}}else try{D0=(()=>{throw new Error("Cannot require module "+"@img/sharp-wasm32/versions");})()}catch($){}D0.sharp=M1().version;if(D0.heif&&W0.heif)W0.heif.input.fileSuffix=[".avif"],W0.heif.output.alias=["avif"];function y4($){if(c.bool($))if($)return M.cache(50,20,100);else return M.cache(0,0,0);else if(c.object($))return M.cache($.memory,$.files,$.items);else return M.cache()}y4(!0);function Zq($){return M.concurrency(c.integer($)?$:null)}if(E1.familySync()===E1.GLIBC&&!M._isUsingJemalloc())M.concurrency(1);else if(E1.familySync()===E1.MUSL&&M.concurrency()===1024)M.concurrency(f("os").availableParallelism());var Yq=new Nq.EventEmitter;function jq(){return M.counters()}function Gq($){return M.simd(c.bool($)?$:null)}function Aq($){if(c.object($))if(Array.isArray($.operation)&&$.operation.every(c.string))M.block($.operation,!0);else throw c.invalidParameterError("operation","Array<string>",$.operation);else throw c.invalidParameterError("options","object",$)}function Xq($){if(c.object($))if(Array.isArray($.operation)&&$.operation.every(c.string))M.block($.operation,!1);else throw c.invalidParameterError("operation","Array<string>",$.operation);else throw c.invalidParameterError("options","object",$)}x4.exports=($)=>{$.cache=y4,$.concurrency=Zq,$.counters=jq,$.simd=Gq,$.format=W0,$.interpolators=Iq,$.versions=D0,$.queue=Yq,$.block=Aq,$.unblock=Xq}});var M4=w((xR,_4)=>{/*!
  Copyright 2013 Lovell Fuller and others.
  SPDX-License-Identifier: Apache-2.0
*/var o=a$();s$()(o);P4()(o);q4()(o);K4()(o);w4()(o);L4()(o);F4()(o);S4()(o);_4.exports=o});var Q1=($,P,H)=>{return(q,W)=>{let R=-1;return J(0);async function J(K){if(K<=R)throw Error("next() called multiple times");R=K;let E,I=!1,Z;if($[K])Z=$[K][0][0],q.req.routeIndex=K;else Z=K===$.length&&W||void 0;if(Z)try{E=await Z(q,()=>J(K+1))}catch(X){if(X instanceof Error&&P)q.error=X,E=await P(X,q),I=!0;else throw X}else if(q.finalized===!1&&H)E=await H(q);if(E&&(q.finalized===!1||I))q.res=E;return q}}};var p1=Symbol();var i1=async($,P=Object.create(null))=>{let{all:H=!1,dot:q=!1}=P,R=($ instanceof v0?$.raw.headers:$.headers).get("Content-Type");if(R?.startsWith("multipart/form-data")||R?.startsWith("application/x-www-form-urlencoded"))return u4($,{all:H,dot:q});return{}};async function u4($,P){let H=await $.formData();if(H)return l4(H,P);return{}}function l4($,P){let H=Object.create(null);if($.forEach((q,W)=>{if(!(P.all||W.endsWith("[]")))H[W]=q;else m4(H,W,q)}),P.dot)Object.entries(H).forEach(([q,W])=>{if(q.includes("."))r4(H,q,W),delete H[q]});return H}var m4=($,P,H)=>{if($[P]!==void 0)if(Array.isArray($[P]))$[P].push(H);else $[P]=[$[P],H];else if(!P.endsWith("[]"))$[P]=H;else $[P]=[H]},r4=($,P,H)=>{let q=$,W=P.split(".");W.forEach((R,J)=>{if(J===W.length-1)q[R]=H;else{if(!q[R]||typeof q[R]!=="object"||Array.isArray(q[R])||q[R]instanceof File)q[R]=Object.create(null);q=q[R]}})};var Z1=($)=>{let P=$.split("/");if(P[0]==="")P.shift();return P},o1=($)=>{let{groups:P,path:H}=a4($),q=Z1(H);return e4(q,P)},a4=($)=>{let P=[];return $=$.replace(/\{[^}]+\}/g,(H,q)=>{let W=`@${q}`;return P.push([W,H]),W}),{groups:P,path:$}},e4=($,P)=>{for(let H=P.length-1;H>=0;H--){let[q]=P[H];for(let W=$.length-1;W>=0;W--)if($[W].includes(q)){$[W]=$[W].replace(q,P[H][1]);break}}return $},b0={},$2=($,P)=>{if($==="*")return"*";let H=$.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/);if(H){let q=`${$}#${P}`;if(!b0[q])if(H[2])b0[q]=P&&P[0]!==":"&&P[0]!=="*"?[q,H[1],new RegExp(`^${H[2]}(?=/${P})`)]:[$,H[1],new RegExp(`^${H[2]}$`)];else b0[q]=[$,H[1],!0];return b0[q]}return null},c0=($,P)=>{try{return P($)}catch{return $.replace(/(?:%[0-9A-Fa-f]{2})+/g,(H)=>{try{return P(H)}catch{return H}})}},n4=($)=>c0($,decodeURI),Y1=($)=>{let P=$.url,H=P.indexOf("/",P.indexOf(":")+4),q=H;for(;q<P.length;q++){let W=P.charCodeAt(q);if(W===37){let R=P.indexOf("?",q),J=P.slice(H,R===-1?void 0:R);return n4(J.includes("%25")?J.replace(/%25/g,"%2525"):J)}else if(W===63)break}return P.slice(H,q)};var P2=($)=>{let P=Y1($);return P.length>1&&P.at(-1)==="/"?P.slice(0,-1):P},R0=($,P,...H)=>{if(H.length)P=R0(P,...H);return`${$?.[0]==="/"?"":"/"}${$}${P==="/"?"":`${$?.at(-1)==="/"?"":"/"}${P?.[0]==="/"?P.slice(1):P}`}`},O0=($)=>{if($.charCodeAt($.length-1)!==63||!$.includes(":"))return null;let P=$.split("/"),H=[],q="";return P.forEach((W)=>{if(W!==""&&!/\:/.test(W))q+="/"+W;else if(/\:/.test(W))if(/\?/.test(W)){if(H.length===0&&q==="")H.push("/");else H.push(q);let R=W.replace("?","");q+="/"+R,H.push(q)}else q+="/"+W}),H.filter((W,R,J)=>J.indexOf(W)===R)},I1=($)=>{if(!/[%+]/.test($))return $;if($.indexOf("+")!==-1)$=$.replace(/\+/g," ");return $.indexOf("%")!==-1?c0($,j1):$},H2=($,P,H)=>{let q;if(!H&&P&&!/[%+]/.test(P)){let J=$.indexOf("?",8);if(J===-1)return;if(!$.startsWith(P,J+1))J=$.indexOf(`&${P}`,J+1);while(J!==-1){let K=$.charCodeAt(J+P.length+1);if(K===61){let E=J+P.length+2,I=$.indexOf("&",E);return I1($.slice(E,I===-1?void 0:I))}else if(K==38||isNaN(K))return"";J=$.indexOf(`&${P}`,J+1)}if(q=/[%+]/.test($),!q)return}let W={};q??=/[%+]/.test($);let R=$.indexOf("?",8);while(R!==-1){let J=$.indexOf("&",R+1),K=$.indexOf("=",R);if(K>J&&J!==-1)K=-1;let E=$.slice(R+1,K===-1?J===-1?void 0:J:K);if(q)E=I1(E);if(R=J,E==="")continue;let I;if(K===-1)I="";else if(I=$.slice(K+1,J===-1?void 0:J),q)I=I1(I);if(H){if(!(W[E]&&Array.isArray(W[E])))W[E]=[];W[E].push(I)}else W[E]??=I}return P?W[P]:W},q2=H2,W2=($,P)=>{return H2($,P,!0)},j1=decodeURIComponent;var R2=($)=>c0($,j1),v0=class{raw;#$;#P;routeIndex=0;path;bodyCache={};constructor($,P="/",H=[[]]){this.raw=$,this.path=P,this.#P=H,this.#$={}}param($){return $?this.#H($):this.#R()}#H($){let P=this.#P[0][this.routeIndex][1][$],H=this.#W(P);return H&&/\%/.test(H)?R2(H):H}#R(){let $={},P=Object.keys(this.#P[0][this.routeIndex][1]);for(let H of P){let q=this.#W(this.#P[0][this.routeIndex][1][H]);if(q!==void 0)$[H]=/\%/.test(q)?R2(q):q}return $}#W($){return this.#P[1]?this.#P[1][$]:$}query($){return q2(this.url,$)}queries($){return W2(this.url,$)}header($){if($)return this.raw.headers.get($)??void 0;let P={};return this.raw.headers.forEach((H,q)=>{P[q]=H}),P}async parseBody($){return this.bodyCache.parsedBody??=await i1(this,$)}#q=($)=>{let{bodyCache:P,raw:H}=this,q=P[$];if(q)return q;let W=Object.keys(P)[0];if(W)return P[W].then((R)=>{if(W==="json")R=JSON.stringify(R);return new Response(R)[$]()});return P[$]=H[$]()};json(){return this.#q("text").then(($)=>JSON.parse($))}text(){return this.#q("text")}arrayBuffer(){return this.#q("arrayBuffer")}blob(){return this.#q("blob")}formData(){return this.#q("formData")}addValidatedData($,P){this.#$[$]=P}valid($){return this.#$[$]}get url(){return this.raw.url}get method(){return this.raw.method}get[p1](){return this.#P}get matchedRoutes(){return this.#P[0].map(([[,$]])=>$)}get routePath(){return this.#P[0].map(([[,$]])=>$)[this.routeIndex].path}};var J2={Stringify:1,BeforeStream:2,Stream:3},s4=($,P)=>{let H=new String($);return H.isEscaped=!0,H.callbacks=P,H};var G1=async($,P,H,q,W)=>{if(typeof $==="object"&&!($ instanceof String)){if(!($ instanceof Promise))$=$.toString();if($ instanceof Promise)$=await $}let R=$.callbacks;if(!R?.length)return Promise.resolve($);if(W)W[0]+=$;else W=[$];let J=Promise.all(R.map((K)=>K({phase:P,buffer:W,context:q}))).then((K)=>Promise.all(K.filter(Boolean).map((E)=>G1(E,P,!1,q,W))).then(()=>W[0]));if(H)return s4(await J,R);else return J};var t4="text/plain; charset=UTF-8",A1=($,P)=>{return{"Content-Type":$,...P}},U2=class{#$;#P;env={};#H;finalized=!1;error;#R;#W;#q;#N;#K;#E;#U;#Q;#I;constructor($,P){if(this.#$=$,P)this.#W=P.executionCtx,this.env=P.env,this.#E=P.notFoundHandler,this.#I=P.path,this.#Q=P.matchResult}get req(){return this.#P??=new v0(this.#$,this.#I,this.#Q),this.#P}get event(){if(this.#W&&"respondWith"in this.#W)return this.#W;else throw Error("This context has no FetchEvent")}get executionCtx(){if(this.#W)return this.#W;else throw Error("This context has no ExecutionContext")}get res(){return this.#q||=new Response(null,{headers:this.#U??=new Headers})}set res($){if(this.#q&&$){$=new Response($.body,$);for(let[P,H]of this.#q.headers.entries()){if(P==="content-type")continue;if(P==="set-cookie"){let q=this.#q.headers.getSetCookie();$.headers.delete("set-cookie");for(let W of q)$.headers.append("set-cookie",W)}else $.headers.set(P,H)}}this.#q=$,this.finalized=!0}render=(...$)=>{return this.#K??=(P)=>this.html(P),this.#K(...$)};setLayout=($)=>this.#N=$;getLayout=()=>this.#N;setRenderer=($)=>{this.#K=$};header=($,P,H)=>{if(this.finalized)this.#q=new Response(this.#q.body,this.#q);let q=this.#q?this.#q.headers:this.#U??=new Headers;if(P===void 0)q.delete($);else if(H?.append)q.append($,P);else q.set($,P)};status=($)=>{this.#R=$};set=($,P)=>{this.#H??=new Map,this.#H.set($,P)};get=($)=>{return this.#H?this.#H.get($):void 0};get var(){if(!this.#H)return{};return Object.fromEntries(this.#H)}#J($,P,H){let q=this.#q?new Headers(this.#q.headers):this.#U??new Headers;if(typeof P==="object"&&"headers"in P){let R=P.headers instanceof Headers?P.headers:new Headers(P.headers);for(let[J,K]of R)if(J.toLowerCase()==="set-cookie")q.append(J,K);else q.set(J,K)}if(H)for(let[R,J]of Object.entries(H))if(typeof J==="string")q.set(R,J);else{q.delete(R);for(let K of J)q.append(R,K)}let W=typeof P==="number"?P:P?.status??this.#R;return new Response($,{status:W,headers:q})}newResponse=(...$)=>this.#J(...$);body=($,P,H)=>this.#J($,P,H);text=($,P,H)=>{return!this.#U&&!this.#R&&!P&&!H&&!this.finalized?new Response($):this.#J($,P,A1(t4,H))};json=($,P,H)=>{return this.#J(JSON.stringify($),P,A1("application/json",H))};html=($,P,H)=>{let q=(W)=>this.#J(W,P,A1("text/html; charset=UTF-8",H));return typeof $==="object"?G1($,J2.Stringify,!1,{}).then(q):q($)};redirect=($,P)=>{let H=String($);return this.header("Location",!/[^\x00-\xFF]/.test(H)?H:encodeURI(H)),this.newResponse(null,P??302)};notFound=()=>{return this.#E??=()=>new Response,this.#E(this)}};var L="ALL",K2="all",E2=["get","post","put","delete","options","patch"],g0="Can not add a route since the matcher is already built.",u0=class extends Error{};var N2="__COMPOSED_HANDLER";var p4=($)=>{return $.text("404 Not Found",404)},Q2=($,P)=>{if("getResponse"in $){let H=$.getResponse();return P.newResponse(H.body,H)}return console.error($),P.text("Internal Server Error",500)},X1=class{get;post;put;delete;options;patch;all;on;use;router;getPath;_basePath="/";#$="/";routes=[];constructor($={}){[...E2,K2].forEach((W)=>{this[W]=(R,...J)=>{if(typeof R==="string")this.#$=R;else this.#R(W,this.#$,R);return J.forEach((K)=>{this.#R(W,this.#$,K)}),this}}),this.on=(W,R,...J)=>{for(let K of[R].flat()){this.#$=K;for(let E of[W].flat())J.map((I)=>{this.#R(E.toUpperCase(),this.#$,I)})}return this},this.use=(W,...R)=>{if(typeof W==="string")this.#$=W;else this.#$="*",R.unshift(W);return R.forEach((J)=>{this.#R(L,this.#$,J)}),this};let{strict:H,...q}=$;Object.assign(this,q),this.getPath=H??!0?$.getPath??Y1:P2}#P(){let $=new X1({router:this.router,getPath:this.getPath});return $.errorHandler=this.errorHandler,$.#H=this.#H,$.routes=this.routes,$}#H=p4;errorHandler=Q2;route($,P){let H=this.basePath($);return P.routes.map((q)=>{let W;if(P.errorHandler===Q2)W=q.handler;else W=async(R,J)=>(await Q1([],P.errorHandler)(R,()=>q.handler(R,J))).res,W[N2]=q.handler;H.#R(q.method,q.path,W)}),this}basePath($){let P=this.#P();return P._basePath=R0(this._basePath,$),P}onError=($)=>{return this.errorHandler=$,this};notFound=($)=>{return this.#H=$,this};mount($,P,H){let q,W;if(H)if(typeof H==="function")W=H;else if(W=H.optionHandler,H.replaceRequest===!1)q=(K)=>K;else q=H.replaceRequest;let R=W?(K)=>{let E=W(K);return Array.isArray(E)?E:[E]}:(K)=>{let E=void 0;try{E=K.executionCtx}catch{}return[K.env,E]};q||=(()=>{let K=R0(this._basePath,$),E=K==="/"?0:K.length;return(I)=>{let Z=new URL(I.url);return Z.pathname=Z.pathname.slice(E)||"/",new Request(Z,I)}})();let J=async(K,E)=>{let I=await P(q(K.req.raw),...R(K));if(I)return I;await E()};return this.#R(L,R0($,"*"),J),this}#R($,P,H){$=$.toUpperCase(),P=R0(this._basePath,P);let q={basePath:this._basePath,path:P,method:$,handler:H};this.router.add($,P,[H,q]),this.routes.push(q)}#W($,P){if($ instanceof Error)return this.errorHandler($,P);throw $}#q($,P,H,q){if(q==="HEAD")return(async()=>new Response(null,await this.#q($,P,H,"GET")))();let W=this.getPath($,{env:H}),R=this.router.match(q,W),J=new U2($,{path:W,matchResult:R,env:H,executionCtx:P,notFoundHandler:this.#H});if(R[0].length===1){let E;try{E=R[0][0][0][0](J,async()=>{J.res=await this.#H(J)})}catch(I){return this.#W(I,J)}return E instanceof Promise?E.then((I)=>I||(J.finalized?J.res:this.#H(J))).catch((I)=>this.#W(I,J)):E??this.#H(J)}let K=Q1(R[0],this.errorHandler,this.#H);return(async()=>{try{let E=await K(J);if(!E.finalized)throw Error("Context is not finalized. Did you forget to return a Response object or `await next()`?");return E.res}catch(E){return this.#W(E,J)}})()}fetch=($,...P)=>{return this.#q($,P[1],P[0],$.method)};request=($,P,H,q)=>{if($ instanceof Request)return this.fetch(P?new Request($,P):$,H,q);return $=$.toString(),this.fetch(new Request(/^https?:\/\//.test($)?$:`http://localhost${R0("/",$)}`,P),H,q)};fire=()=>{addEventListener("fetch",($)=>{$.respondWith(this.#q($.request,$,void 0,$.request.method))})}};var F0=[];function l0($,P){let H=this.buildAllMatchers(),q=(W,R)=>{let J=H[W]||H[L],K=J[2][R];if(K)return K;let E=R.match(J[0]);if(!E)return[[],F0];let I=E.indexOf("",1);return[J[1][I],E]};return this.match=q,q($,P)}var m0="[^/]+",C0=".*",y0="(?:|/.*)",J0=Symbol(),i4=new Set(".\\+*[^]$()");function o4($,P){if($.length===1)return P.length===1?$<P?-1:1:-1;if(P.length===1)return 1;if($===C0||$===y0)return 1;else if(P===C0||P===y0)return-1;if($===m0)return 1;else if(P===m0)return-1;return $.length===P.length?$<P?-1:1:P.length-$.length}var r0=class{#$;#P;#H=Object.create(null);insert($,P,H,q,W){if($.length===0){if(this.#$!==void 0)throw J0;if(W)return;this.#$=P;return}let[R,...J]=$,K=R==="*"?J.length===0?["","",C0]:["","",m0]:R==="/*"?["","",y0]:R.match(/^\:([^\{\}]+)(?:\{(.+)\})?$/),E;if(K){let I=K[1],Z=K[2]||m0;if(I&&K[2]){if(Z===".*")throw J0;if(Z=Z.replace(/^\((?!\?:)(?=[^)]+\)$)/,"(?:"),/\((?!\?:)/.test(Z))throw J0}if(E=this.#H[Z],!E){if(Object.keys(this.#H).some((X)=>X!==C0&&X!==y0))throw J0;if(W)return;if(E=this.#H[Z]=new r0,I!=="")E.#P=q.varIndex++}if(!W&&I!=="")H.push([I,E.#P])}else if(E=this.#H[R],!E){if(Object.keys(this.#H).some((I)=>I.length>1&&I!==C0&&I!==y0))throw J0;if(W)return;E=this.#H[R]=new r0}E.insert(J,P,H,q,W)}buildRegExpStr(){let P=Object.keys(this.#H).sort(o4).map((H)=>{let q=this.#H[H];return(typeof q.#P==="number"?`(${H})@${q.#P}`:i4.has(H)?`\\${H}`:H)+q.buildRegExpStr()});if(typeof this.#$==="number")P.unshift(`#${this.#$}`);if(P.length===0)return"";if(P.length===1)return P[0];return"(?:"+P.join("|")+")"}};var I2=class{#$={varIndex:0};#P=new r0;insert($,P,H){let q=[],W=[];for(let J=0;;){let K=!1;if($=$.replace(/\{[^}]+\}/g,(E)=>{let I=`@\\${J}`;return W[J]=[I,E],J++,K=!0,I}),!K)break}let R=$.match(/(?::[^\/]+)|(?:\/\*$)|./g)||[];for(let J=W.length-1;J>=0;J--){let[K]=W[J];for(let E=R.length-1;E>=0;E--)if(R[E].indexOf(K)!==-1){R[E]=R[E].replace(K,W[J][1]);break}}return this.#P.insert(R,P,q,this.#$,H),q}buildRegExp(){let $=this.#P.buildRegExpStr();if($==="")return[/^$/,[],[]];let P=0,H=[],q=[];return $=$.replace(/#(\d+)|@(\d+)|\.\*\$/g,(W,R,J)=>{if(R!==void 0)return H[++P]=Number(R),"$()";if(J!==void 0)return q[Number(J)]=++P,"";return""}),[new RegExp(`^${$}`),H,q]}};var $P=[/^$/,[],Object.create(null)],Z2=Object.create(null);function Y2($){return Z2[$]??=new RegExp($==="*"?"":`^${$.replace(/\/\*$|([.\\+*[^\]$()])/g,(P,H)=>H?`\\${H}`:"(?:|/.*)")}$`)}function PP(){Z2=Object.create(null)}function HP($){let P=new I2,H=[];if($.length===0)return $P;let q=$.map((I)=>[!/\*|\/:/.test(I[0]),...I]).sort(([I,Z],[X,z])=>I?1:X?-1:Z.length-z.length),W=Object.create(null);for(let I=0,Z=-1,X=q.length;I<X;I++){let[z,v,F]=q[I];if(z)W[v]=[F.map(([b])=>[b,Object.create(null)]),F0];else Z++;let k;try{k=P.insert(v,Z,z)}catch(b){throw b===J0?new u0(v):b}if(z)continue;H[Z]=F.map(([b,I0])=>{let f0=Object.create(null);I0-=1;for(;I0>=0;I0--){let[g,N1]=k[I0];f0[g]=N1}return[b,f0]})}let[R,J,K]=P.buildRegExp();for(let I=0,Z=H.length;I<Z;I++)for(let X=0,z=H[I].length;X<z;X++){let v=H[I][X]?.[1];if(!v)continue;let F=Object.keys(v);for(let k=0,b=F.length;k<b;k++)v[F[k]]=K[v[F[k]]]}let E=[];for(let I in J)E[I]=H[J[I]];return[R,E,W]}function Z0($,P){if(!$)return;for(let H of Object.keys($).sort((q,W)=>W.length-q.length))if(Y2(H).test(P))return[...$[H]];return}var a0=class{name="RegExpRouter";#$;#P;constructor(){this.#$={[L]:Object.create(null)},this.#P={[L]:Object.create(null)}}add($,P,H){let q=this.#$,W=this.#P;if(!q||!W)throw Error(g0);if(!q[$])[q,W].forEach((K)=>{K[$]=Object.create(null),Object.keys(K[L]).forEach((E)=>{K[$][E]=[...K[L][E]]})});if(P==="/*")P="*";let R=(P.match(/\/:/g)||[]).length;if(/\*$/.test(P)){let K=Y2(P);if($===L)Object.keys(q).forEach((E)=>{q[E][P]||=Z0(q[E],P)||Z0(q[L],P)||[]});else q[$][P]||=Z0(q[$],P)||Z0(q[L],P)||[];Object.keys(q).forEach((E)=>{if($===L||$===E)Object.keys(q[E]).forEach((I)=>{K.test(I)&&q[E][I].push([H,R])})}),Object.keys(W).forEach((E)=>{if($===L||$===E)Object.keys(W[E]).forEach((I)=>K.test(I)&&W[E][I].push([H,R]))});return}let J=O0(P)||[P];for(let K=0,E=J.length;K<E;K++){let I=J[K];Object.keys(W).forEach((Z)=>{if($===L||$===Z)W[Z][I]||=[...Z0(q[Z],I)||Z0(q[L],I)||[]],W[Z][I].push([H,R-E+K+1])})}}match=l0;buildAllMatchers(){let $=Object.create(null);return Object.keys(this.#P).concat(Object.keys(this.#$)).forEach((P)=>{$[P]||=this.#H(P)}),this.#$=this.#P=void 0,PP(),$}#H($){let P=[],H=$===L;if([this.#$,this.#P].forEach((q)=>{let W=q[$]?Object.keys(q[$]).map((R)=>[R,q[$][R]]):[];if(W.length!==0)H||=!0,P.push(...W);else if($!==L)P.push(...Object.keys(q[L]).map((R)=>[R,q[L][R]]))}),!H)return null;else return HP(P)}};var qP=class{name="PreparedRegExpRouter";#$;#P;constructor($,P){this.#$=$,this.#P=P}#H($,P){let H=this.#$[$];H[1].forEach((q)=>q&&q.push(P)),Object.values(H[2]).forEach((q)=>q[0].push(P))}#R($,P,H,q,W){let R=this.#$[$];if(!W)R[2][P][0].push([H,{}]);else q.forEach((J)=>{if(typeof J==="number")R[1][J].push([H,W]);else R[2][J||P][0].push([H,W])})}add($,P,H){if(!this.#$[$]){let W=this.#$[L],R={};for(let J in W[2])R[J]=[W[2][J][0].slice(),F0];this.#$[$]=[W[0],W[1].map((J)=>Array.isArray(J)?J.slice():0),R]}if(P==="/*"||P==="*"){let W=[H,{}];if($===L)for(let R in this.#$)this.#H(R,W);else this.#H($,W);return}let q=this.#P[P];if(!q)throw Error(`Path ${P} is not registered`);for(let[W,R]of q)if($===L)for(let J in this.#$)this.#R(J,P,H,W,R);else this.#R($,P,H,W,R)}buildAllMatchers(){return this.#$}match=l0};var B1=class{name="SmartRouter";#$=[];#P=[];constructor($){this.#$=$.routers}add($,P,H){if(!this.#P)throw Error(g0);this.#P.push([$,P,H])}match($,P){if(!this.#P)throw Error("Fatal error");let H=this.#$,q=this.#P,W=H.length,R=0,J;for(;R<W;R++){let K=H[R];try{for(let E=0,I=q.length;E<I;E++)K.add(...q[E]);J=K.match($,P)}catch(E){if(E instanceof u0)continue;throw E}this.match=K.match.bind(K),this.#$=[K],this.#P=void 0;break}if(R===W)throw Error("Fatal error");return this.name=`SmartRouter + ${this.activeRouter.name}`,J}get activeRouter(){if(this.#P||this.#$.length!==1)throw Error("No active router has been determined yet.");return this.#$[0]}};var x0=Object.create(null),w1=class{#$;#P;#H;#R=0;#W=x0;constructor($,P,H){if(this.#P=H||Object.create(null),this.#$=[],$&&P){let q=Object.create(null);q[$]={handler:P,possibleKeys:[],score:0},this.#$=[q]}this.#H=[]}insert($,P,H){this.#R=++this.#R;let q=this,W=o1(P),R=[];for(let J=0,K=W.length;J<K;J++){let E=W[J],I=W[J+1],Z=$2(E,I),X=Array.isArray(Z)?Z[0]:E;if(X in q.#P){if(q=q.#P[X],Z)R.push(Z[1]);continue}if(q.#P[X]=new w1,Z)q.#H.push(Z),R.push(Z[1]);q=q.#P[X]}return q.#$.push({[$]:{handler:H,possibleKeys:R.filter((J,K,E)=>E.indexOf(J)===K),score:this.#R}}),q}#q($,P,H,q){let W=[];for(let R=0,J=$.#$.length;R<J;R++){let K=$.#$[R],E=K[P]||K[L],I={};if(E!==void 0){if(E.params=Object.create(null),W.push(E),H!==x0||q&&q!==x0)for(let Z=0,X=E.possibleKeys.length;Z<X;Z++){let z=E.possibleKeys[Z],v=I[E.score];E.params[z]=q?.[z]&&!v?q[z]:H[z]??q?.[z],I[E.score]=!0}}}return W}search($,P){let H=[];this.#W=x0;let W=[this],R=Z1(P),J=[];for(let K=0,E=R.length;K<E;K++){let I=R[K],Z=K===E-1,X=[];for(let z=0,v=W.length;z<v;z++){let F=W[z],k=F.#P[I];if(k)if(k.#W=F.#W,Z){if(k.#P["*"])H.push(...this.#q(k.#P["*"],$,F.#W));H.push(...this.#q(k,$,F.#W))}else X.push(k);for(let b=0,I0=F.#H.length;b<I0;b++){let f0=F.#H[b],g=F.#W===x0?{}:{...F.#W};if(f0==="*"){let $0=F.#P["*"];if($0)H.push(...this.#q($0,$,F.#W)),$0.#W=g,X.push($0);continue}let[N1,s1,T0]=f0;if(!I&&!(T0 instanceof RegExp))continue;let s=F.#P[N1],h4=R.slice(K).join("/");if(T0 instanceof RegExp){let $0=T0.exec(h4);if($0){if(g[s1]=$0[0],H.push(...this.#q(s,$,F.#W,g)),Object.keys(s.#P).length){s.#W=g;let d4=$0[0].match(/\//)?.length??0;(J[d4]||=[]).push(s)}continue}}if(T0===!0||T0.test(I))if(g[s1]=I,Z){if(H.push(...this.#q(s,$,g,F.#W)),s.#P["*"])H.push(...this.#q(s.#P["*"],$,g,F.#W))}else s.#W=g,X.push(s)}}W=X.concat(J.shift()??[])}if(H.length>1)H.sort((K,E)=>{return K.score-E.score});return[H.map(({handler:K,params:E})=>[K,E])]}};var V1=class{name="TrieRouter";#$;constructor(){this.#$=new w1}add($,P,H){let q=O0(P);if(q){for(let W=0,R=q.length;W<R;W++)this.#$.insert($,q[W],H);return}this.#$.insert($,P,H)}match($,P){return this.#$.search($,P)}};var L1=class extends X1{constructor($={}){super($);this.router=$.router??new B1({routers:[new a0,new V1]})}};var n1=g4(M4(),1),k4=new L1;async function Bq(){let q=await n1.default("./public/birthday-voucher-template.png").metadata(),{width:W=1080,height:R=1080}=q,J=`
    <svg width="${W}" height="${R}">
      <defs>
        <filter id="shadow">
          <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.5"/>
        </filter>
      </defs>
      <text x="335" y="520" 
            font-family="Brush Script MT, cursive" 
            font-size="48" 
            font-weight="bold"
            fill="#FFD700"
            filter="url(#shadow)">Sarah Abdullah</text>
    </svg>
  `,K=`
    <svg width="${W}" height="${R}">
      <text x="470" y="1008" 
            font-family="Arial, sans-serif" 
            font-size="32" 
            font-weight="bold"
            fill="#FFFFFF">31 Desember 2024</text>
    </svg>
  `;return await n1.default("./public/birthday-voucher-template.png").composite([{input:Buffer.from(J),top:0,left:0},{input:Buffer.from(K),top:0,left:0}]).png().toBuffer()}k4.get("/",async($)=>{try{let P=await Bq();return new Response(P,{headers:{"Content-Type":"image/png"}})}catch(P){return $.json({error:P.message},500)}});var MR=k4;export{MR as default};
